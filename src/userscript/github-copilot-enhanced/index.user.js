// ==UserScript==
// @name         Github Copilot Enhanced
// @name:en      Github Copilot Enhanced
// @name:zh-CN   Github Copilot 增强
// @namespace    https://github.com/ZiuChen/userscript
// @version      0.0.1
// @description  Enhances the GitHub Copilot (Web) user experience by enabling long-term local chat history storage, real-time search with shortcuts and highlighting, automatic scheduled data synchronization, and seamless interception and merging of requests, providing more convenient, reliable, and secure Copilot chat management.
// @description:en Enhances the GitHub Copilot (Web) user experience by enabling long-term local chat history storage, real-time search with shortcuts and highlighting, automatic scheduled data synchronization, and seamless interception and merging of requests, providing more convenient, reliable, and secure Copilot chat management.
// @description:zh-CN 增强 GitHub Copilot (Web) 的使用体验，主要功能包括本地长期保存聊天记录、支持快捷键和高亮显示的实时搜索、自动定时同步数据、无缝拦截和合并请求，实现更加便捷、可靠和安全的 Copilot 聊天管理。
// @author       ZiuChen
// @match        https://github.com/copilot*
// @icon         data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0Ij48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik04LjY2MiAxNC40ODRhMS4wMDEgMS4wMDEgMCAxIDEgMi4wMDMgMHYxLjk5N2ExLjAwMSAxLjAwMSAwIDEgMS0yLjAwMyAwem02LjY3NSAwYTEuMDAxIDEuMDAxIDAgMSAwLTIuMDAzIDB2MS45OTdhMS4wMDEgMS4wMDEgMCAxIDAgMi4wMDMgMHpNMTEuOTk5IDQuMDI4Yy0uODQ1LTEuMjE5LTIuNTk4LTEuMzEtMy45NDUtMS4xODhjLTEuNTQzLjE1NC0yLjg0My42ODUtMy41NzQgMS40NjRjLTEuMjY4IDEuMzg2LTEuMzI2IDQuMjkxLS43MTUgNS44OWMtLjA2MS4yNzQtLjEyLjU1MS0uMTYyLjg0NWMtMS4xMy4yOTctMi4yODMgMS44OTgtMi4yODMgMy4wNDN2Mi4xNjJjMCAuNi4yOCAxLjE0OC43NzUgMS41MjJDNC45MTkgMTkuODY0IDguNDM5IDIxLjQ5IDEyIDIxLjQ5czcuMDgtMS42MjYgOS45MDQtMy43MjRhMS44OSAxLjg5IDAgMCAwIC43NzUtMS41MjF2LTIuMTYzYzAtMS4xNDUtMS4xNTMtMi43NDYtMi4yODMtMy4wNDNjLS4wNDItLjI5NC0uMS0uNTctLjE2Mi0uODQ0Yy42MTEtMS42LjU1Mi00LjUwNS0uNzE1LTUuODljLS43MzEtLjc4LTIuMDMtMS4zMS0zLjU3NC0xLjQ2NWMtMS4zNDctLjEyMS0zLjEtLjAzLTMuOTQ2IDEuMTg4bTYuNjc1IDEzLjQ2Yy0xLjUzNS44NTQtNC4wODUgMi02LjY3NCAycy01LjE0LTEuMTQ2LTYuNjc1LTJ2LTUuNzk5YzIuNDc3Ljk2IDUuMzI3LjQ2NSA2LjY3My0xLjc1OEgxMmMxLjM0NiAyLjIyMyA0LjE5NiAyLjcxNyA2LjY3MyAxLjc1OHptLTguMDEtMTAuNjZjMCAxLjU4Ni0uNDggMy4zMTItMi42NyAzLjMxMnMtMi42MDYtLjUyNC0yLjYwNi0xLjk5N2MwLTIuMzM2LjM1Ni0zLjMzNiAzLjMxNi0zLjMzNmMxLjcxIDAgMS45Ni41NSAxLjk2IDIuMDIybTIuNjcgMGMwLTEuNDcyLjI1LTIuMDIgMS45NjEtMi4wMmMyLjk2IDAgMy4zMTYgMSAzLjMxNiAzLjMzNWMwIDEuNDczLS40MTcgMS45OTctMi42MDcgMS45OTdzLTIuNjctMS43MjYtMi42Ny0zLjMxMSIvPjwvc3ZnPg==
// @grant        GM.xmlHttpRequest
// @grant        unsafeWindow
// @connect      api.individual.githubcopilot.com
// @run-at       document-start
// @updateURL    https://cdn.jsdelivr.net/gh/ZiuChen/userscript@main/src/userscript/github-copilot-enhanced/index.user.js
// @downloadURL  https://cdn.jsdelivr.net/gh/ZiuChen/userscript@main/src/userscript/github-copilot-enhanced/index.user.js
// ==/UserScript==

(function(){var e=unsafeWindow.fetch,t=[];unsafeWindow.fetch=async(n,r)=>{if(!t.length)return e(n,r);let i={request:new Request(n,r),fetch:e};for(let e of t)if(e?.onBeforeFetch){let t=await e.onBeforeFetch(i);t instanceof Request?i.request=t:t instanceof Response&&(i.response=t)}i.response||=await e(i.request);for(let e of t)if(e?.onAfterFetch){let t=await e.onAfterFetch(i);t instanceof Response&&(i.response=t)}return i.response};function n(e){t.push(e)}var r=(e,t)=>t.some(t=>e instanceof t),i,a;function o(){return i||=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]}function s(){return a||=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]}var c=new WeakMap,l=new WeakMap,u=new WeakMap;function d(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener(`success`,i),e.removeEventListener(`error`,a)},i=()=>{t(_(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener(`success`,i),e.addEventListener(`error`,a)});return u.set(t,e),t}function f(e){if(c.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener(`complete`,i),e.removeEventListener(`error`,a),e.removeEventListener(`abort`,a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException(`AbortError`,`AbortError`)),r()};e.addEventListener(`complete`,i),e.addEventListener(`error`,a),e.addEventListener(`abort`,a)});c.set(e,t)}var p={get(e,t,n){if(e instanceof IDBTransaction){if(t===`done`)return c.get(e);if(t===`store`)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t===`done`||t===`store`)?!0:t in e}};function m(e){p=e(p)}function h(e){return s().includes(e)?function(...t){return e.apply(v(this),t),_(this.request)}:function(...t){return _(e.apply(v(this),t))}}function g(e){return typeof e==`function`?h(e):(e instanceof IDBTransaction&&f(e),r(e,o())?new Proxy(e,p):e)}function _(e){if(e instanceof IDBRequest)return d(e);if(l.has(e))return l.get(e);let t=g(e);return t!==e&&(l.set(e,t),u.set(t,e)),t}var v=e=>u.get(e);function y(e,t,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){let o=indexedDB.open(e,t),s=_(o);return r&&o.addEventListener(`upgradeneeded`,e=>{r(_(o.result),e.oldVersion,e.newVersion,_(o.transaction),e)}),n&&o.addEventListener(`blocked`,e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{a&&e.addEventListener(`close`,()=>a()),i&&e.addEventListener(`versionchange`,e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}var b=[`get`,`getKey`,`getAll`,`getAllKeys`,`count`],x=[`put`,`add`,`delete`,`clear`],S=new Map;function C(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t==`string`))return;if(S.get(t))return S.get(t);let n=t.replace(/FromIndex$/,``),r=t!==n,i=x.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||b.includes(n)))return;let a=async function(e,...t){let a=this.transaction(e,i?`readwrite`:`readonly`),o=a.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&a.done]))[0]};return S.set(t,a),a}m(e=>({...e,get:(t,n,r)=>C(t,n)||e.get(t,n,r),has:(t,n)=>!!C(t,n)||e.has(t,n)}));var ee=[`continue`,`continuePrimaryKey`,`advance`],te={},ne=new WeakMap,re=new WeakMap,ie={get(e,t){if(!ee.includes(t))return e[t];let n=te[t];return n||=te[t]=function(...e){ne.set(this,re.get(this)[t](...e))},n}};async function*ae(...e){let t=this;if(t instanceof IDBCursor||(t=await t.openCursor(...e)),!t)return;t=t;let n=new Proxy(t,ie);for(re.set(n,t),u.set(n,v(t));t;)yield n,t=await(ne.get(n)||t.continue()),ne.delete(n)}function oe(e,t){return t===Symbol.asyncIterator&&r(e,[IDBIndex,IDBObjectStore,IDBCursor])||t===`iterate`&&r(e,[IDBIndex,IDBObjectStore])}m(e=>({...e,get(t,n,r){return oe(t,n)?ae:e.get(t,n,r)},has(t,n){return oe(t,n)||e.has(t,n)}}));var se=`copilot-chat-history`,ce=1,w=`threads`,le=`messages`,ue=null;function de(){return ue||=y(se,ce,{upgrade(e){if(!e.objectStoreNames.contains(w)){let t=e.createObjectStore(w,{keyPath:`id`});t.createIndex(`updatedAt`,`updatedAt`),t.createIndex(`syncedAt`,`syncedAt`)}e.objectStoreNames.contains(le)||e.createObjectStore(le,{keyPath:`threadId`}).createIndex(`syncedAt`,`syncedAt`)}}),ue}let T={async saveThread(e){let t=await de(),n={id:e.id,name:e.name,createdAt:e.createdAt,updatedAt:e.updatedAt,syncedAt:new Date().toISOString(),data:e};await t.put(w,n)},async saveThreads(e){let t=(await de()).transaction(w,`readwrite`);await Promise.all(e.map(e=>{let n={id:e.id,name:e.name,createdAt:e.createdAt,updatedAt:e.updatedAt,syncedAt:new Date().toISOString(),data:e};return t.store.put(n)})),await t.done},async getAllThreads(){return(await de()).getAll(w)},async saveMessages(e,t){let n=await de(),r={threadId:e,syncedAt:new Date().toISOString(),messages:t};await n.put(le,r)},async getMessages(e){return(await de()).get(le,e)},async getAllMessages(){return(await de()).getAll(le)},async getThread(e){return(await de()).get(w,e)},async deleteThread(e){let t=(await de()).transaction([w,le],`readwrite`);await Promise.all([t.objectStore(w).delete(e),t.objectStore(le).delete(e)]),await t.done},async clearAll(){let e=(await de()).transaction([w,le],`readwrite`);await Promise.all([e.objectStore(w).clear(),e.objectStore(le).clear()]),await e.done}};function fe(e){let t=e.trim();if(!t)return new Headers;let n=t.split(`\r
`).map(e=>{let t=e.split(`:`);return[t[0].trim(),t[1].trim()]});return new Headers(n)}function pe(e,t){let n=fe(t.responseHeaders),r=typeof t.response==`string`?new Blob([t.response],{type:n.get(`Content-Type`)||`text/plain`}):t.response;return new me(r,{statusCode:t.status,statusText:t.statusText,headers:n,finalUrl:t.finalUrl,redirected:t.finalUrl===e.url})}var me=class e{constructor(e,t){this.rawBody=e,this.init=t,this.body=e.stream();let{headers:n,statusCode:r,statusText:i,finalUrl:a,redirected:o}=t;this.headers=n,this.status=r,this.statusText=i,this.url=a,this.type=`basic`,this.redirected=o,this._bodyUsed=!1}get bodyUsed(){return this._bodyUsed}get ok(){return this.status<300}arrayBuffer(){if(this.bodyUsed)throw TypeError(`Failed to execute 'arrayBuffer' on 'Response': body stream already read`);return this._bodyUsed=!0,this.rawBody.arrayBuffer()}blob(){if(this.bodyUsed)throw TypeError(`Failed to execute 'blob' on 'Response': body stream already read`);return this._bodyUsed=!0,Promise.resolve(this.rawBody.slice(0,this.rawBody.size,this.rawBody.type))}clone(){if(this.bodyUsed)throw TypeError(`Failed to execute 'clone' on 'Response': body stream already read`);return new e(this.rawBody,this.init)}formData(){if(this.bodyUsed)throw TypeError(`Failed to execute 'formData' on 'Response': body stream already read`);return this._bodyUsed=!0,this.rawBody.text().then(he)}async json(){if(this.bodyUsed)throw TypeError(`Failed to execute 'json' on 'Response': body stream already read`);return this._bodyUsed=!0,JSON.parse(await this.rawBody.text())}text(){if(this.bodyUsed)throw TypeError(`Failed to execute 'text' on 'Response': body stream already read`);return this._bodyUsed=!0,this.rawBody.text()}async bytes(){if(this.bodyUsed)throw TypeError(`Failed to execute 'bytes' on 'Response': body stream already read`);return this._bodyUsed=!0,new Uint8Array(await this.rawBody.arrayBuffer())}};function he(e){let t=new FormData;return e.trim().split(`&`).forEach(function(e){if(e){let n=e.split(`=`),r=n.shift()?.replace(/\+/g,` `),i=n.join(`=`).replace(/\+/g,` `);t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}async function ge(e,t){let n=new Request(e,t),r;return t?.body&&(r=await n.text()),await _e(n,t,r)}function _e(e,t,n){return new Promise((r,i)=>{if(e.signal&&e.signal.aborted)return i(new DOMException(`Aborted`,`AbortError`));GM.xmlHttpRequest({url:e.url,method:be(e.method.toUpperCase()),headers:Object.fromEntries(new Headers(t?.headers).entries()),data:n,responseType:`blob`,onload(t){try{r(pe(e,t))}catch(e){i(e)}},onabort(){i(new DOMException(`Aborted`,`AbortError`))},ontimeout(){i(TypeError(`Network request failed, timeout`))},onerror(e){i(TypeError(`Failed to fetch: `+e.finalUrl))}})})}var ve=[`GET`,`POST`,`PUT`,`DELETE`,`PATCH`,`HEAD`,`TRACE`,`OPTIONS`,`CONNECT`];function ye(e,t){return e.includes(t)}function be(e){if(ye(ve,e))return e;throw Error(`unsupported http method ${e}`)}var xe=`https://api.individual.githubcopilot.com`;function Se(){try{let e=localStorage.getItem(`COPILOT_AUTH_TOKEN`);if(e){let t=JSON.parse(e);if(t.value)return t.value}}catch(e){console.warn(`[Auth] Failed to get token from COPILOT_AUTH_TOKEN:`,e)}throw Error(`Failed to get GitHub Copilot auth token`)}var Ce=null;let we={async fetchAllThreads(){let e=Se(),t=await ge(`${xe}/github/chat/threads`,{headers:{Accept:`application/json`,Authorization:`GitHub-Bearer ${e}`}});if(!t.ok)throw Error(`Failed to fetch threads: ${t.status}`);return t.json()},async fetchThreadMessages(e){let t=Se(),n=await ge(`${xe}/github/chat/threads/${e}/messages`,{headers:{Accept:`application/json`,Authorization:`GitHub-Bearer ${t}`}});if(!n.ok)throw Error(`Failed to fetch messages for thread ${e}: ${n.status}`);return n.json()},async syncThread(e){try{console.debug(`[Sync] Syncing thread: ${e}`);let t=await this.fetchThreadMessages(e);await T.saveThread(t.thread),await T.saveMessages(e,t.messages),console.debug(`[Sync] Thread ${e} synced successfully`)}catch(t){throw console.error(`[Sync] Failed to sync thread ${e}:`,t),t}},async syncAllThreads(){try{console.info(`[Sync] Starting sync for all threads...`);let e=await this.fetchAllThreads();console.info(`[Sync] Found ${e.threads.length} threads`),await T.saveThreads(e.threads);let t=e.threads.map(async e=>{let t=await T.getThread(e.id);if(!(t&&new Date(t.updatedAt).getTime()>=new Date(e.updatedAt).getTime()))try{let t=await this.fetchThreadMessages(e.id);await T.saveMessages(e.id,t.messages),console.debug(`[Sync] Thread ${e.id} synced`)}catch(t){console.error(`[Sync] Failed to sync thread ${e.id}, skipping...`,t)}});await Promise.all(t),console.info(`[Sync] All threads synced successfully`)}catch(e){throw console.error(`[Sync] Failed to sync all threads:`,e),e}},startAutoSync(e=30){this.syncAllThreads().catch(e=>{console.error(`[Sync] Initial sync failed:`,e)}),Ce&&clearInterval(Ce),Ce=setInterval(()=>{this.syncAllThreads().catch(e=>{console.error(`[Sync] Auto sync failed:`,e)})},e*60*1e3),console.info(`[Sync] Auto sync started, interval: ${e} minutes`)}};async function Te(e){try{let t=await T.getAllThreads(),n=new Set(e.threads.map(e=>e.id)),r=t.filter(e=>!n.has(e.id)).map(e=>e.data);return console.info(`[Merge] Server threads: ${e.threads.length}, Local additional threads: ${r.length}`),{threads:[...e.threads,...r]}}catch(t){return console.error(`[Merge] Failed to merge threads:`,t),e}}var Ee=Array.isArray,De=Array.prototype.indexOf,Oe=Array.from;Object.keys;var ke=Object.defineProperty,Ae=Object.getOwnPropertyDescriptor,je=Object.getOwnPropertyDescriptors,Me=Object.prototype,Ne=Array.prototype,Pe=Object.getPrototypeOf,Fe=Object.isExtensible;function Ie(e){return typeof e==`function`}let Le=()=>{};function Re(e){for(var t=0;t<e.length;t++)e[t]()}function ze(){var e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}}let Be=1024,Ve=2048,He=4096,Ue=8192,We=1<<19,Ge=1<<21,Ke=1<<23,qe=Symbol(`$state`),Je=Symbol(``),Ye=new class extends Error{name=`StaleReactionError`;message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function Xe(e){throw Error(`https://svelte.dev/e/lifecycle_outside_component`)}function Ze(){throw Error(`https://svelte.dev/e/async_derived_orphan`)}function Qe(e){throw Error(`https://svelte.dev/e/effect_in_teardown`)}function $e(){throw Error(`https://svelte.dev/e/effect_in_unowned_derived`)}function et(e){throw Error(`https://svelte.dev/e/effect_orphan`)}function tt(){throw Error(`https://svelte.dev/e/effect_update_depth_exceeded`)}function nt(){throw Error(`https://svelte.dev/e/state_descriptors_fixed`)}function rt(){throw Error(`https://svelte.dev/e/state_prototype_fixed`)}function it(){throw Error(`https://svelte.dev/e/state_unsafe_mutation`)}function at(){throw Error(`https://svelte.dev/e/svelte_boundary_reset_onerror`)}let ot={},E=Symbol();function st(e){console.warn(`https://svelte.dev/e/hydration_mismatch`)}function ct(){console.warn(`https://svelte.dev/e/select_multiple_invalid_value`)}function lt(){console.warn(`https://svelte.dev/e/svelte_boundary_reset_noop`)}let D=!1;function ut(e){D=e}let O;function k(e){if(e===null)throw st(),ot;return O=e}function dt(){return k(L(O))}function A(e){if(D){if(L(O)!==null)throw st(),ot;O=e}}function ft(e=1){if(D){for(var t=e,n=O;t--;)n=L(n);O=n}}function pt(e=!0){for(var t=0,n=O;;){if(n.nodeType===8){var r=n.data;if(r===`]`){if(t===0)return n;--t}else (r===`[`||r===`[!`)&&(t+=1)}var i=L(n);e&&n.remove(),n=i}}function mt(e){if(!e||e.nodeType!==8)throw st(),ot;return e.data}function ht(e){return e===this.v}function gt(e,t){return e==e?e!==t||typeof e==`object`&&!!e||typeof e==`function`:t==t}function _t(e){return!gt(e,this.v)}let j=null;function vt(e){j=e}function yt(e,t=!1,n){j={p:j,c:null,e:null,s:e,x:null,l:null}}function bt(e){var t=j,n=t.e;if(n!==null){t.e=null;for(var r of n)Ln(r)}return e!==void 0&&(t.x=e),j=t.p,e??{}}function xt(){return!0}var St=[];function Ct(){var e=St;St=[],Re(e)}function wt(e){if(St.length===0&&!It){var t=St;queueMicrotask(()=>{t===St&&Ct()})}St.push(e)}function Tt(){for(;St.length>0;)Ct()}var Et=new WeakMap;function Dt(e){var t=W;if(t===null)return V.f|=Ke,e;if(t.f&32768)Ot(e,t);else{if(!(t.f&128))throw!t.parent&&e instanceof Error&&kt(e),e;t.b.error(e)}}function Ot(e,t){for(;t!==null;){if(t.f&128)try{t.b.error(e);return}catch(t){e=t}t=t.parent}throw e instanceof Error&&kt(e),e}function kt(e){let t=Et.get(e);t&&(ke(e,`message`,{value:t.message}),ke(e,`stack`,{value:t.stack}))}var At=new Set;let M=null,jt=null,N=null,Mt=new Set;var Nt=[],Pt=null,Ft=!1;let It=!1;var Lt=class e{committed=!1;current=new Map;#previous=new Map;#callbacks=new Set;#pending=0;#blocking_pending=0;#deferred=null;#dirty_effects=[];#maybe_dirty_effects=[];skipped_effects=new Set;process(e){Nt=[],jt=null,this.apply();var t={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(let n of e)this.#traverse_effect_tree(n,t);this.#resolve(),this.#blocking_pending>0?(this.#defer_effects(t.effects),this.#defer_effects(t.render_effects),this.#defer_effects(t.block_effects)):(jt=this,M=null,Ht(t.render_effects),Ht(t.effects),jt=null),N=null}#traverse_effect_tree(e,t){e.f^=Be;for(var n=e.first;n!==null;){var r=n.f,i=(r&96)!=0,a=i&&(r&1024)!=0||(r&8192)!=0||this.skipped_effects.has(n);if(n.f&128&&n.b?.is_pending()&&(t={parent:t,effect:n,effects:[],render_effects:[],block_effects:[]}),!a&&n.fn!==null){i?n.f^=Be:r&4?t.effects.push(n):hr(n)&&(n.f&16&&t.block_effects.push(n),br(n));var o=n.first;if(o!==null){n=o;continue}}var s=n.parent;for(n=n.next;n===null&&s!==null;)s===t.effect&&(this.#defer_effects(t.effects),this.#defer_effects(t.render_effects),this.#defer_effects(t.block_effects),t=t.parent),n=s.next,s=s.parent}}#defer_effects(e){for(let t of e)(t.f&2048?this.#dirty_effects:this.#maybe_dirty_effects).push(t),Y(t,Be)}capture(e,t){this.#previous.has(e)||this.#previous.set(e,t),this.current.set(e,e.v),N?.set(e,e.v)}activate(){M=this}deactivate(){M=null,N=null}flush(){if(Nt.length>0){if(this.activate(),zt(),M!==null&&M!==this)return}else this.#resolve();this.deactivate();for(let e of Mt)if(Mt.delete(e),e(),M!==null)break}#resolve(){if(this.#blocking_pending===0){for(let e of this.#callbacks)e();this.#callbacks.clear()}this.#pending===0&&this.#commit()}#commit(){if(At.size>1){this.#previous.clear();var e=N,t=!0,n={parent:null,effect:null,effects:[],render_effects:[],block_effects:[]};for(let e of At){if(e===this){t=!1;continue}let r=[];for(let[n,i]of this.current){if(e.current.has(n))if(t&&i!==e.current.get(n))e.current.set(n,i);else continue;r.push(n)}if(r.length===0)continue;let i=[...e.current.keys()].filter(e=>!this.current.has(e));if(i.length>0){for(let e of r)Ut(e,i);if(Nt.length>0){M=e,e.apply();for(let t of Nt)e.#traverse_effect_tree(t,n);Nt=[],e.deactivate()}}}M=null,N=e}this.committed=!0,At.delete(this),this.#deferred?.resolve()}increment(e){this.#pending+=1,e&&(this.#blocking_pending+=1)}decrement(e){--this.#pending,e&&--this.#blocking_pending;for(let e of this.#dirty_effects)Y(e,Ve),Gt(e);for(let e of this.#maybe_dirty_effects)Y(e,He),Gt(e);this.#dirty_effects=[],this.#maybe_dirty_effects=[],this.flush()}add_callback(e){this.#callbacks.add(e)}settled(){return(this.#deferred??=ze()).promise}static ensure(){if(M===null){let t=M=new e;At.add(M),It||e.enqueue(()=>{M===t&&t.flush()})}return M}static enqueue(e){wt(e)}apply(){}};function Rt(e){var t=It;It=!0;try{var n;for(e&&(M!==null&&zt(),n=e());;){if(Tt(),Nt.length===0&&(M?.flush(),Nt.length===0))return Pt=null,n;zt()}}finally{It=t}}function zt(){var e=tr;Ft=!0;try{var t=0;for(nr(!0);Nt.length>0;){var n=Lt.ensure();t++>1e3&&Bt(),n.process(Nt),sn.clear()}}finally{Ft=!1,nr(e),Pt=null}}function Bt(){try{tt()}catch(e){Ot(e,Pt)}}let Vt=null;function Ht(e){var t=e.length;if(t!==0){for(var n=0;n<t;){var r=e[n++];if(!(r.f&24576)&&hr(r)&&(Vt=new Set,br(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null&&r.ac===null?Jn(r):r.fn=null),Vt?.size>0)){sn.clear();for(let e of Vt){if(e.f&24576)continue;let t=[e],n=e.parent;for(;n!==null;)Vt.has(n)&&(Vt.delete(n),t.push(n)),n=n.parent;for(let e=t.length-1;e>=0;e--){let n=t[e];n.f&24576||br(n)}}Vt.clear()}}Vt=null}}function Ut(e,t){if(e.reactions!==null)for(let n of e.reactions){let e=n.f;e&2?Ut(n,t):e&4194320&&Wt(n,t)&&(Y(n,Ve),Gt(n))}}function Wt(e,t){if(e.deps!==null){for(let n of e.deps)if(t.includes(n)||n.f&2&&Wt(n,t))return!0}return!1}function Gt(e){for(var t=Pt=e;t.parent!==null;){t=t.parent;var n=t.f;if(Ft&&t===W&&n&16)return;if(n&96){if(!(n&1024))return;t.f^=Be}}Nt.push(t)}function Kt(e){let t=0,n=cn(0),r;return()=>{Pn()&&(J(n),Vn(()=>(t===0&&(r=Cr(()=>e(()=>dn(n)))),t+=1,()=>{wt(()=>{--t,t===0&&(r?.(),r=void 0,dn(n))})})))}}var qt=We|65664;function Jt(e,t,n){new Yt(e,t,n)}var Yt=class{parent;#pending=!1;#anchor;#hydrate_open=D?O:null;#props;#children;#effect;#main_effect=null;#pending_effect=null;#failed_effect=null;#offscreen_fragment=null;#local_pending_count=0;#pending_count=0;#is_creating_fallback=!1;#effect_pending=null;#effect_pending_update=()=>{this.#effect_pending&&un(this.#effect_pending,this.#local_pending_count)};#effect_pending_subscriber=Kt(()=>(this.#effect_pending=cn(this.#local_pending_count),()=>{this.#effect_pending=null}));constructor(e,t,n){this.#anchor=e,this.#props=t,this.#children=n,this.parent=W.b,this.#pending=!!this.#props.pending,this.#effect=Un(()=>{if(W.b=this,D){let e=this.#hydrate_open;dt(),e.nodeType===8&&e.data===`[!`?this.#hydrate_pending_content():this.#hydrate_resolved_content()}else{try{this.#main_effect=z(()=>n(this.#anchor))}catch(e){this.error(e)}this.#pending_count>0?this.#show_pending_snippet():this.#pending=!1}},qt),D&&(this.#anchor=O)}#hydrate_resolved_content(){try{this.#main_effect=z(()=>this.#children(this.#anchor))}catch(e){this.error(e)}this.#pending=!1}#hydrate_pending_content(){let e=this.#props.pending;e&&(this.#pending_effect=z(()=>e(this.#anchor)),Lt.enqueue(()=>{this.#main_effect=this.#run(()=>(Lt.ensure(),z(()=>this.#children(this.#anchor)))),this.#pending_count>0?this.#show_pending_snippet():(Yn(this.#pending_effect,()=>{this.#pending_effect=null}),this.#pending=!1)}))}is_pending(){return this.#pending||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#props.pending}#run(e){var t=W,n=V,r=j;ar(this.#effect),U(this.#effect),vt(this.#effect.ctx);try{return e()}catch(e){return Dt(e),null}finally{ar(t),U(n),vt(r)}}#show_pending_snippet(){let e=this.#props.pending;this.#main_effect!==null&&(this.#offscreen_fragment=document.createDocumentFragment(),er(this.#main_effect,this.#offscreen_fragment)),this.#pending_effect===null&&(this.#pending_effect=z(()=>e(this.#anchor)))}#update_pending_count(e){if(!this.has_pending_snippet()){this.parent&&this.parent.#update_pending_count(e);return}this.#pending_count+=e,this.#pending_count===0&&(this.#pending=!1,this.#pending_effect&&Yn(this.#pending_effect,()=>{this.#pending_effect=null}),this.#offscreen_fragment&&=(this.#anchor.before(this.#offscreen_fragment),null))}update_pending_count(e){this.#update_pending_count(e),this.#local_pending_count+=e,Mt.add(this.#effect_pending_update)}get_effect_pending(){return this.#effect_pending_subscriber(),J(this.#effect_pending)}error(e){var t=this.#props.onerror;let n=this.#props.failed;if(this.#is_creating_fallback||!t&&!n)throw e;this.#main_effect&&=(B(this.#main_effect),null),this.#pending_effect&&=(B(this.#pending_effect),null),this.#failed_effect&&=(B(this.#failed_effect),null),D&&(k(this.#hydrate_open),ft(),k(pt()));var r=!1,i=!1;let a=()=>{if(r){lt();return}r=!0,i&&at(),Lt.ensure(),this.#local_pending_count=0,this.#failed_effect!==null&&Yn(this.#failed_effect,()=>{this.#failed_effect=null}),this.#pending=this.has_pending_snippet(),this.#main_effect=this.#run(()=>(this.#is_creating_fallback=!1,z(()=>this.#children(this.#anchor)))),this.#pending_count>0?this.#show_pending_snippet():this.#pending=!1};var o=V;try{U(null),i=!0,t?.(e,a),i=!1}catch(e){Ot(e,this.#effect&&this.#effect.parent)}finally{U(o)}n&&wt(()=>{this.#failed_effect=this.#run(()=>{this.#is_creating_fallback=!0;try{return z(()=>{n(this.#anchor,()=>e,()=>a)})}catch(e){return Ot(e,this.#effect.parent),null}finally{this.#is_creating_fallback=!1}})})}};function Xt(e,t,n){let r=xt()?$t:tn;if(t.length===0){n(e.map(r));return}var i=M,a=W,o=Zt(),s=D;Promise.all(t.map(e=>en(e))).then(t=>{o();try{n([...e.map(r),...t])}catch(e){a.f&16384||Ot(e,a)}s&&ut(!1),i?.deactivate(),Qt()}).catch(e=>{Ot(e,a)})}function Zt(){var e=W,t=V,n=j,r=M,i=D;if(i)var a=O;return function(){ar(e),U(t),vt(n),r?.activate(),i&&(ut(!0),k(a))}}function Qt(){ar(null),U(null),vt(null)}function $t(e){var t=2|Ve,n=V!==null&&V.f&2?V:null;return W===null||n!==null&&n.f&256?t|=256:W.f|=We,{ctx:j,deps:null,effects:null,equals:ht,f:t,fn:e,reactions:null,rv:0,v:E,wv:0,parent:n??W,ac:null}}function en(e,t){let n=W;n===null&&Ze();var r=n.b,i=void 0,a=cn(E),o=!V,s=new Map;return Bn(()=>{var t=ze();i=t.promise;try{Promise.resolve(e()).then(t.resolve,t.reject).then(()=>{n===M&&n.committed&&n.deactivate(),Qt()})}catch(e){t.reject(e),Qt()}var n=M;if(o){var c=!r.is_pending();r.update_pending_count(1),n.increment(c),s.get(n)?.reject(Ye),s.delete(n),s.set(n,t)}let l=(e,t=void 0)=>{if(n.activate(),t)t!==Ye&&(a.f|=Ke,un(a,t));else{a.f&8388608&&(a.f^=Ke),un(a,e);for(let[e,t]of s){if(s.delete(e),e===n)break;t.reject(Ye)}}o&&(r.update_pending_count(-1),n.decrement(c))};t.promise.then(l,e=>l(null,e||`unknown`))}),Fn(()=>{for(let e of s.values())e.reject(Ye)}),new Promise(e=>{function t(n){function r(){n===i?e(a):t(i)}n.then(r,r)}t(i)})}function tn(e){let t=$t(e);return t.equals=_t,t}function nn(e){var t=e.effects;if(t!==null){e.effects=null;for(var n=0;n<t.length;n+=1)B(t[n])}}function rn(e){for(var t=e.parent;t!==null;){if(!(t.f&2))return t;t=t.parent}return null}function an(e){var t,n=W;ar(rn(e));try{nn(e),t=_r(e)}finally{ar(n)}return t}function on(e){var t=an(e);if(e.equals(t)||(e.v=t,e.wv=mr()),!rr)if(N!==null)N.set(e,e.v);else{var n=(pr||e.f&256)&&e.deps!==null?He:Be;Y(e,n)}}let sn=new Map;function cn(e,t){return{f:0,v:e,reactions:null,equals:ht,rv:0,wv:0}}function P(e,t){let n=cn(e,t);return sr(n),n}function ln(e,t=!1,n=!0){let r=cn(e);return t||(r.equals=_t),r}function F(e,t,n=!1){V!==null&&(!H||V.f&131072)&&xt()&&V.f&4325394&&!or?.includes(e)&&it();let r=n?pn(t):t;return un(e,r)}function un(e,t){if(!e.equals(t)){var n=e.v;rr?sn.set(e,t):sn.set(e,n),e.v=t,Lt.ensure().capture(e,n),e.f&2&&(e.f&2048&&an(e),Y(e,e.f&256?He:Be)),e.wv=mr(),fn(e,Ve),xt()&&W!==null&&W.f&1024&&!(W.f&96)&&(q===null?cr([e]):q.push(e))}return t}function dn(e){F(e,e.v+1)}function fn(e,t){var n=e.reactions;if(n!==null)for(var r=xt(),i=n.length,a=0;a<i;a++){var o=n[a],s=o.f;if(!(!r&&o===W)){var c=(s&Ve)===0;c&&Y(o,t),s&2?fn(o,He):c&&(s&16&&Vt!==null&&Vt.add(o),Gt(o))}}}function pn(e){if(typeof e!=`object`||!e||qe in e)return e;let t=Pe(e);if(t!==Me&&t!==Ne)return e;var n=new Map,r=Ee(e),i=P(0),a=null,o=dr,s=e=>{if(dr===o)return e();var t=V,n=dr;U(null),fr(o);var r=e();return U(t),fr(n),r};return r&&n.set(`length`,P(e.length,a)),new Proxy(e,{defineProperty(e,t,r){(!(`value`in r)||r.configurable===!1||r.enumerable===!1||r.writable===!1)&&nt();var i=n.get(t);return i===void 0?i=s(()=>{var e=P(r.value,a);return n.set(t,e),e}):F(i,r.value,!0),!0},deleteProperty(e,t){var r=n.get(t);if(r===void 0){if(t in e){let e=s(()=>P(E,a));n.set(t,e),dn(i)}}else F(r,E),dn(i);return!0},get(t,r,i){if(r===qe)return e;var o=n.get(r),c=r in t;if(o===void 0&&(!c||Ae(t,r)?.writable)&&(o=s(()=>{var e=pn(c?t[r]:E);return P(e,a)}),n.set(r,o)),o!==void 0){var l=J(o);return l===E?void 0:l}return Reflect.get(t,r,i)},getOwnPropertyDescriptor(e,t){var r=Reflect.getOwnPropertyDescriptor(e,t);if(r&&`value`in r){var i=n.get(t);i&&(r.value=J(i))}else if(r===void 0){var a=n.get(t),o=a?.v;if(a!==void 0&&o!==E)return{enumerable:!0,configurable:!0,value:o,writable:!0}}return r},has(e,t){if(t===qe)return!0;var r=n.get(t),i=r!==void 0&&r.v!==E||Reflect.has(e,t);return(r!==void 0||W!==null&&(!i||Ae(e,t)?.writable))&&(r===void 0&&(r=s(()=>{var n=i?pn(e[t]):E;return P(n,a)}),n.set(t,r)),J(r)===E)?!1:i},set(e,t,o,c){var l=n.get(t),u=t in e;if(r&&t===`length`)for(var d=o;d<l.v;d+=1){var f=n.get(d+``);f===void 0?d in e&&(f=s(()=>P(E,a)),n.set(d+``,f)):F(f,E)}if(l===void 0)(!u||Ae(e,t)?.writable)&&(l=s(()=>P(void 0,a)),F(l,pn(o)),n.set(t,l));else{u=l.v!==E;var p=s(()=>pn(o));F(l,p)}var m=Reflect.getOwnPropertyDescriptor(e,t);if(m?.set&&m.set.call(c,o),!u){if(r&&typeof t==`string`){var h=n.get(`length`),g=Number(t);Number.isInteger(g)&&g>=h.v&&F(h,g+1)}dn(i)}return!0},ownKeys(e){J(i);var t=Reflect.ownKeys(e).filter(e=>{var t=n.get(e);return t===void 0||t.v!==E});for(var[r,a]of n)a.v!==E&&!(r in e)&&t.push(r);return t},setPrototypeOf(){rt()}})}function mn(e){try{if(typeof e==`object`&&e&&qe in e)return e[qe]}catch{}return e}function hn(e,t){return Object.is(mn(e),mn(t))}var gn,_n,vn,yn;function bn(){if(gn===void 0){gn=window,document,_n=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,n=Text.prototype;vn=Ae(t,`firstChild`).get,yn=Ae(t,`nextSibling`).get,Fe(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),Fe(n)&&(n.__t=void 0)}}function xn(e=``){return document.createTextNode(e)}function I(e){return vn.call(e)}function L(e){return yn.call(e)}function R(e,t){if(!D)return I(e);var n=I(O);if(n===null)n=O.appendChild(xn());else if(t&&n.nodeType!==3){var r=xn();return n?.before(r),k(r),r}return k(n),n}function Sn(e,t=!1){if(!D){var n=I(e);return n instanceof Comment&&n.data===``?L(n):n}if(t&&O?.nodeType!==3){var r=xn();return O?.before(r),k(r),r}return O}function Cn(e,t=1,n=!1){let r=D?O:e;for(var i;t--;)i=r,r=L(r);if(!D)return r;if(n&&r?.nodeType!==3){var a=xn();return r===null?i?.after(a):r.before(a),k(a),a}return k(r),r}function wn(e){e.textContent=``}function Tn(){return!1}function En(e,t){if(t){let t=document.body;e.autofocus=!0,wt(()=>{document.activeElement===t&&e.focus()})}}var Dn=!1;function On(){Dn||(Dn=!0,document.addEventListener(`reset`,e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(let t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function kn(e){var t=V,n=W;U(null),ar(null);try{return e()}finally{U(t),ar(n)}}function An(e,t,n,r=n){e.addEventListener(t,()=>kn(n));let i=e.__on_r;i?e.__on_r=()=>{i(),r(!0)}:e.__on_r=()=>r(!0),On()}function jn(e){W===null&&V===null&&et(e),V!==null&&V.f&256&&W===null&&$e(),rr&&Qe(e)}function Mn(e,t){var n=t.last;n===null?t.last=t.first=e:(n.next=e,e.prev=n,t.last=e)}function Nn(e,t,n,r=!0){var i=W;i!==null&&i.f&8192&&(e|=Ue);var a={ctx:j,deps:null,nodes_start:null,nodes_end:null,f:e|Ve,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(n)try{br(a),a.f|=32768}catch(e){throw B(a),e}else t!==null&&Gt(a);if(r){var o=a;if(n&&o.deps===null&&o.teardown===null&&o.nodes_start===null&&o.first===o.last&&!(o.f&524288)&&(o=o.first),o!==null&&(o.parent=i,i!==null&&Mn(o,i),V!==null&&V.f&2&&!(e&64))){var s=V;(s.effects??=[]).push(o)}}return a}function Pn(){return V!==null&&!H}function Fn(e){let t=Nn(8,null,!1);return Y(t,Be),t.teardown=e,t}function In(e){jn(`$effect`);var t=W.f;if(!V&&t&32&&!(t&32768)){var n=j;(n.e??=[]).push(e)}else return Ln(e)}function Ln(e){return Nn(1048580,e,!1)}function Rn(e){Lt.ensure();let t=Nn(64|We,e,!0);return(e={})=>new Promise(n=>{e.outro?Yn(t,()=>{B(t),n(void 0)}):(B(t),n(void 0))})}function zn(e){return Nn(4,e,!1)}function Bn(e){return Nn(4194304|We,e,!0)}function Vn(e,t=0){return Nn(8|t,e,!0)}function Hn(e,t=[],n=[]){Xt(t,n,t=>{Nn(8,()=>e(...t.map(J)),!0)})}function Un(e,t=0){return Nn(16|t,e,!0)}function z(e,t=!0){return Nn(32|We,e,!0,t)}function Wn(e){var t=e.teardown;if(t!==null){let e=rr,n=V;ir(!0),U(null);try{t.call(null)}finally{ir(e),U(n)}}}function Gn(e,t=!1){var n=e.first;for(e.first=e.last=null;n!==null;){let e=n.ac;e!==null&&kn(()=>{e.abort(Ye)});var r=n.next;n.f&64?n.parent=null:B(n,t),n=r}}function Kn(e){for(var t=e.first;t!==null;){var n=t.next;t.f&32||B(t),t=n}}function B(e,t=!0){var n=!1;(t||e.f&262144)&&e.nodes_start!==null&&e.nodes_end!==null&&(qn(e.nodes_start,e.nodes_end),n=!0),Gn(e,t&&!n),yr(e,0),Y(e,16384);var r=e.transitions;if(r!==null)for(let e of r)e.stop();Wn(e);var i=e.parent;i!==null&&i.first!==null&&Jn(e),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function qn(e,t){for(;e!==null;){var n=e===t?null:L(e);e.remove(),e=n}}function Jn(e){var t=e.parent,n=e.prev,r=e.next;n!==null&&(n.next=r),r!==null&&(r.prev=n),t!==null&&(t.first===e&&(t.first=r),t.last===e&&(t.last=n))}function Yn(e,t,n=!0){var r=[];Zn(e,r,!0),Xn(r,()=>{n&&B(e),t&&t()})}function Xn(e,t){var n=e.length;if(n>0){var r=()=>--n||t();for(var i of e)i.out(r)}else t()}function Zn(e,t,n){if(!(e.f&8192)){if(e.f^=Ue,e.transitions!==null)for(let r of e.transitions)(r.is_global||n)&&t.push(r);for(var r=e.first;r!==null;){var i=r.next,a=(r.f&65536)!=0||(r.f&32)!=0;Zn(r,t,a?n:!1),r=i}}}function Qn(e){$n(e,!0)}function $n(e,t){if(e.f&8192){e.f^=Ue,e.f&1024||(Y(e,Ve),Gt(e));for(var n=e.first;n!==null;){var r=n.next,i=(n.f&65536)!=0||(n.f&32)!=0;$n(n,i?t:!1),n=r}if(e.transitions!==null)for(let n of e.transitions)(n.is_global||t)&&n.in()}}function er(e,t){for(var n=e.nodes_start,r=e.nodes_end;n!==null;){var i=n===r?null:L(n);t.append(n),n=i}}let tr=!1;function nr(e){tr=e}let rr=!1;function ir(e){rr=e}let V=null,H=!1;function U(e){V=e}let W=null;function ar(e){W=e}let or=null;function sr(e){V!==null&&(or===null?or=[e]:or.push(e))}var G=null,K=0;let q=null;function cr(e){q=e}let lr=1;var ur=0;let dr=ur;function fr(e){dr=e}let pr=!1;function mr(){return++lr}function hr(e){var t=e.f;if(t&2048)return!0;if(t&4096){var n=e.deps,r=(t&256)!=0;if(n!==null){var i,a,o=(t&512)!=0,s=r&&W!==null&&!pr,c=n.length;if((o||s)&&(W===null||!(W.f&16384))){var l=e,u=l.parent;for(i=0;i<c;i++)a=n[i],(o||!a?.reactions?.includes(l))&&(a.reactions??=[]).push(l);o&&(l.f^=512),s&&u!==null&&!(u.f&256)&&(l.f^=256)}for(i=0;i<c;i++)if(a=n[i],hr(a)&&on(a),a.wv>e.wv)return!0}(!r||W!==null&&!pr)&&Y(e,Be)}return!1}function gr(e,t,n=!0){var r=e.reactions;if(r!==null&&!or?.includes(e))for(var i=0;i<r.length;i++){var a=r[i];a.f&2?gr(a,t,!1):t===a&&(n?Y(a,Ve):a.f&1024&&Y(a,He),Gt(a))}}function _r(e){var t=G,n=K,r=q,i=V,a=pr,o=or,s=j,c=H,l=dr,u=e.f;G=null,K=0,q=null,pr=(u&256)!=0&&(H||!tr||V===null),V=u&96?null:e,or=null,vt(e.ctx),H=!1,dr=++ur,e.ac!==null&&(kn(()=>{e.ac.abort(Ye)}),e.ac=null);try{e.f|=Ge;var d=e.fn,f=d(),p=e.deps;if(G!==null){var m;if(yr(e,K),p!==null&&K>0)for(p.length=K+G.length,m=0;m<G.length;m++)p[K+m]=G[m];else e.deps=p=G;if(!pr||u&2&&e.reactions!==null)for(m=K;m<p.length;m++)(p[m].reactions??=[]).push(e)}else p!==null&&K<p.length&&(yr(e,K),p.length=K);if(xt()&&q!==null&&!H&&p!==null&&!(e.f&6146))for(m=0;m<q.length;m++)gr(q[m],e);return i!==null&&i!==e&&(ur++,q!==null&&(r===null?r=q:r.push(...q))),e.f&8388608&&(e.f^=Ke),f}catch(e){return Dt(e)}finally{e.f^=Ge,G=t,K=n,q=r,V=i,pr=a,or=o,vt(s),H=c,dr=l}}function vr(e,t){let n=t.reactions;if(n!==null){var r=De.call(n,e);if(r!==-1){var i=n.length-1;i===0?n=t.reactions=null:(n[r]=n[i],n.pop())}}n===null&&t.f&2&&(G===null||!G.includes(t))&&(Y(t,He),t.f&768||(t.f^=512),nn(t),yr(t,0))}function yr(e,t){var n=e.deps;if(n!==null)for(var r=t;r<n.length;r++)vr(e,n[r])}function br(e){var t=e.f;if(!(t&16384)){Y(e,Be);var n=W,r=tr;W=e,tr=!0;try{t&16?Kn(e):Gn(e),Wn(e);var i=_r(e);e.teardown=typeof i==`function`?i:null,e.wv=lr}finally{tr=r,W=n}}}async function xr(){await Promise.resolve(),Rt()}function J(e){var t=(e.f&2)!=0;if(null?.add(e),V!==null&&!H){if(!(W!==null&&W.f&16384)&&!or?.includes(e)){var n=V.deps;if(V.f&2097152)e.rv<ur&&(e.rv=ur,G===null&&n!==null&&n[K]===e?K++:G===null?G=[e]:(!pr||!G.includes(e))&&G.push(e));else{(V.deps??=[]).push(e);var r=e.reactions;r===null?e.reactions=[V]:r.includes(V)||r.push(V)}}}else if(t&&e.deps===null&&e.effects===null){var i=e,a=i.parent;a!==null&&!(a.f&256)&&(i.f^=256)}if(rr){if(sn.has(e))return sn.get(e);if(t){i=e;var o=i.v;return(!(i.f&1024)&&i.reactions!==null||Sr(i))&&(o=an(i)),sn.set(i,o),o}}else if(t){if(i=e,N?.has(i))return N.get(i);hr(i)&&on(i)}if(N?.has(e))return N.get(e);if(e.f&8388608)throw e.v;return e.v}function Sr(e){if(e.v===E)return!0;if(e.deps===null)return!1;for(let t of e.deps)if(sn.has(t)||t.f&2&&Sr(t))return!0;return!1}function Cr(e){var t=H;try{return H=!0,e()}finally{H=t}}var wr=~(He|3072);function Y(e,t){e.f=e.f&wr|t}function Tr(e){return e.endsWith(`capture`)&&e!==`gotpointercapture`&&e!==`lostpointercapture`}var Er=[`beforeinput`,`click`,`change`,`dblclick`,`contextmenu`,`focusin`,`focusout`,`input`,`keydown`,`keyup`,`mousedown`,`mousemove`,`mouseout`,`mouseover`,`mouseup`,`pointerdown`,`pointermove`,`pointerout`,`pointerover`,`pointerup`,`touchend`,`touchmove`,`touchstart`];function Dr(e){return Er.includes(e)}var Or=`allowfullscreen.async.autofocus.autoplay.checked.controls.default.disabled.formnovalidate.indeterminate.inert.ismap.loop.multiple.muted.nomodule.novalidate.open.playsinline.readonly.required.reversed.seamless.selected.webkitdirectory.defer.disablepictureinpicture.disableremoteplayback`.split(`.`),kr={formnovalidate:`formNoValidate`,ismap:`isMap`,nomodule:`noModule`,playsinline:`playsInline`,readonly:`readOnly`,defaultvalue:`defaultValue`,defaultchecked:`defaultChecked`,srcobject:`srcObject`,novalidate:`noValidate`,allowfullscreen:`allowFullscreen`,disablepictureinpicture:`disablePictureInPicture`,disableremoteplayback:`disableRemotePlayback`};function Ar(e){return e=e.toLowerCase(),kr[e]??e}[...Or];var jr=[`touchstart`,`touchmove`];function Mr(e){return jr.includes(e)}let Nr=new Set,Pr=new Set;function Fr(e,t,n,r={}){function i(e){if(r.capture||Rr.call(t,e),!e.cancelBubble)return kn(()=>n?.call(this,e))}return e.startsWith(`pointer`)||e.startsWith(`touch`)||e===`wheel`?wt(()=>{t.addEventListener(e,i,r)}):t.addEventListener(e,i,r),i}function Ir(e){for(var t=0;t<e.length;t++)Nr.add(e[t]);for(var n of Pr)n(e)}var Lr=null;function Rr(e){var t=this,n=t.ownerDocument,r=e.type,i=e.composedPath?.()||[],a=i[0]||e.target;Lr=e;var o=0,s=Lr===e&&e.__root;if(s){var c=i.indexOf(s);if(c!==-1&&(t===document||t===window)){e.__root=t;return}var l=i.indexOf(t);if(l===-1)return;c<=l&&(o=c)}if(a=i[o]||e.target,a!==t){ke(e,`currentTarget`,{configurable:!0,get(){return a||n}});var u=V,d=W;U(null),ar(null);try{for(var f,p=[];a!==null;){var m=a.assignedSlot||a.parentNode||a.host||null;try{var h=a[`__`+r];if(h!=null&&(!a.disabled||e.target===a))if(Ee(h)){var[g,..._]=h;g.apply(a,[e,..._])}else h.call(a,e)}catch(e){f?p.push(e):f=e}if(e.cancelBubble||m===t||m===null)break;a=m}if(f){for(let e of p)queueMicrotask(()=>{throw e});throw f}}finally{e.__root=t,delete e.currentTarget,U(u),ar(d)}}}function zr(e){var t=document.createElement(`template`);return t.innerHTML=e.replaceAll(`<!>`,`<!---->`),t.content}function X(e,t){var n=W;n.nodes_start===null&&(n.nodes_start=e,n.nodes_end=t)}function Br(e,t){var n=(t&1)!=0,r=(t&2)!=0,i,a=!e.startsWith(`<!>`);return()=>{if(D)return X(O,null),O;i===void 0&&(i=zr(a?e:`<!>`+e),n||(i=I(i)));var t=r||_n?document.importNode(i,!0):i.cloneNode(!0);if(n){var o=I(t),s=t.lastChild;X(o,s)}else X(t,t);return t}}function Vr(e,t,n=`svg`){var r=!e.startsWith(`<!>`),i=(t&1)!=0,a=`<${n}>${r?e:`<!>`+e}</${n}>`,o;return()=>{if(D)return X(O,null),O;if(!o){var e=zr(a),t=I(e);if(i)for(o=document.createDocumentFragment();I(t);)o.appendChild(I(t));else o=I(t)}var n=o.cloneNode(!0);if(i){var r=I(n),s=n.lastChild;X(r,s)}else X(n,n);return n}}function Hr(e,t){return Vr(e,t,`svg`)}function Ur(){if(D)return X(O,null),O;var e=document.createDocumentFragment(),t=document.createComment(``),n=xn();return e.append(t,n),X(t,n),e}function Wr(e,t){if(D){W.nodes_end=O,dt();return}e!==null&&e.before(t)}let Gr=!0;function Kr(e,t){var n=t==null?``:typeof t==`object`?t+``:t;n!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+``)}function qr(e,t){return Yr(e,t)}var Jr=new Map;function Yr(e,{target:t,anchor:n,props:r={},events:i,context:a,intro:o=!0}){bn();var s=new Set,c=e=>{for(var n=0;n<e.length;n++){var r=e[n];if(!s.has(r)){s.add(r);var i=Mr(r);t.addEventListener(r,Rr,{passive:i});var a=Jr.get(r);a===void 0?(document.addEventListener(r,Rr,{passive:i}),Jr.set(r,1)):Jr.set(r,a+1)}}};c(Oe(Nr)),Pr.add(c);var l=void 0,u=Rn(()=>{var u=n??t.appendChild(xn());return Jt(u,{pending:()=>{}},t=>{if(a){yt({});var n=j;n.c=a}if(i&&(r.$$events=i),D&&X(t,null),Gr=o,l=e(t,r)||{},Gr=!0,D&&(W.nodes_end=O,O===null||O.nodeType!==8||O.data!==`]`))throw st(),ot;a&&bt()}),()=>{for(var e of s){t.removeEventListener(e,Rr);var r=Jr.get(e);--r===0?(document.removeEventListener(e,Rr),Jr.delete(e)):Jr.set(e,r)}Pr.delete(c),u!==n&&u.parentNode?.removeChild(u)}});return Xr.set(l,u),l}var Xr=new WeakMap,Zr=class{anchor;#batches=new Map;#onscreen=new Map;#offscreen=new Map;#transition=!0;constructor(e,t=!0){this.anchor=e,this.#transition=t}#commit=()=>{var e=M;if(this.#batches.has(e)){var t=this.#batches.get(e),n=this.#onscreen.get(t);if(n)Qn(n);else{var r=this.#offscreen.get(t);r&&(this.#onscreen.set(t,r.effect),this.#offscreen.delete(t),r.fragment.lastChild.remove(),this.anchor.before(r.fragment),n=r.effect)}for(let[t,n]of this.#batches){if(this.#batches.delete(t),t===e)break;let r=this.#offscreen.get(n);r&&(B(r.effect),this.#offscreen.delete(n))}for(let[e,r]of this.#onscreen){if(e===t)continue;let i=()=>{if(Array.from(this.#batches.values()).includes(e)){var t=document.createDocumentFragment();er(r,t),t.append(xn()),this.#offscreen.set(e,{effect:r,fragment:t})}else B(r);this.#onscreen.delete(e)};this.#transition||!n?Yn(r,i,!1):i()}}};ensure(e,t){var n=M,r=Tn();if(t&&!this.#onscreen.has(e)&&!this.#offscreen.has(e))if(r){var i=document.createDocumentFragment(),a=xn();i.append(a),this.#offscreen.set(e,{effect:z(()=>t(a)),fragment:i})}else this.#onscreen.set(e,z(()=>t(this.anchor)));if(this.#batches.set(n,e),r){for(let[t,r]of this.#onscreen)t===e?n.skipped_effects.delete(r):n.skipped_effects.add(r);for(let[t,r]of this.#offscreen)t===e?n.skipped_effects.delete(r.effect):n.skipped_effects.add(r.effect);n.add_callback(this.#commit)}else D&&(this.anchor=O),this.#commit()}};function Qr(e,t,n=!1){D&&dt();var r=new Zr(e),i=n?65536:0;function a(t,n){if(D){let a=mt(e)===`[!`;if(t===a){var i=pt();k(i),r.anchor=i,ut(!1),r.ensure(t,n),ut(!0);return}}r.ensure(t,n)}Un(()=>{var e=!1;t((t,n=!0)=>{e=!0,a(n,t)}),e||a(!1,null)},i)}let $r=null;function ei(e,t){return t}function ti(e,t,n){for(var r=e.items,i=[],a=t.length,o=0;o<a;o++)Zn(t[o].e,i,!0);var s=a>0&&i.length===0&&n!==null;if(s){var c=n.parentNode;wn(c),c.append(n),r.clear(),si(e,t[0].prev,t[a-1].next)}Xn(i,()=>{for(var n=0;n<a;n++){var i=t[n];s||(r.delete(i.k),si(e,i.prev,i.next)),B(i.e,!s)}})}function ni(e,t,n,r,i,a=null){var o=e,s={flags:t,items:new Map,first:null};if(t&4){var c=e;o=D?k(I(c)):c.appendChild(xn())}D&&dt();var l=null,u=!1,d=new Map,f=tn(()=>{var e=n();return Ee(e)?e:e==null?[]:Oe(e)}),p,m;function h(){ri(m,p,s,d,o,i,t,r,n),a!==null&&(p.length===0?l?Qn(l):l=z(()=>a(o)):l!==null&&Yn(l,()=>{l=null}))}Un(()=>{m??=W,p=J(f);var e=p.length;if(u&&e===0)return;u=e===0;let c=!1;if(D&&mt(o)===`[!`!=(e===0)&&(o=pt(),k(o),ut(!1),c=!0),D){for(var g=null,_,v=0;v<e;v++){if(O.nodeType===8&&O.data===`]`){o=O,c=!0,ut(!1);break}var y=p[v],b=r(y,v);_=ai(O,s,g,null,y,b,v,i,t,n),s.items.set(b,_),g=_}e>0&&k(pt())}if(D)e===0&&a&&(l=z(()=>a(o)));else if(Tn()){var x=new Set,S=M;for(v=0;v<e;v+=1){y=p[v],b=r(y,v);var C=s.items.get(b)??d.get(b);C?t&3&&ii(C,y,v,t):(_=ai(null,s,null,null,y,b,v,i,t,n,!0),d.set(b,_)),x.add(b)}for(let[e,t]of s.items)x.has(e)||S.skipped_effects.add(t.e);S.add_callback(h)}else h();c&&ut(!0),J(f)}),D&&(o=O)}function ri(e,t,n,r,i,a,o,s,c){var l=(o&8)!=0,u=(o&3)!=0,d=t.length,f=n.items,p=n.first,m,h=null,g,_=[],v=[],y,b,x,S;if(l)for(S=0;S<d;S+=1)y=t[S],b=s(y,S),x=f.get(b),x!==void 0&&(x.a?.measure(),(g??=new Set).add(x));for(S=0;S<d;S+=1){if(y=t[S],b=s(y,S),x=f.get(b),x===void 0){var C=r.get(b);if(C!==void 0){r.delete(b),f.set(b,C);var ee=h?h.next:p;si(n,h,C),si(n,C,ee),oi(C,ee,i),h=C}else{var te=p?p.e.nodes_start:i;h=ai(te,n,h,h===null?n.first:h.next,y,b,S,a,o,c)}f.set(b,h),_=[],v=[],p=h.next;continue}if(u&&ii(x,y,S,o),x.e.f&8192&&(Qn(x.e),l&&(x.a?.unfix(),(g??=new Set).delete(x))),x!==p){if(m!==void 0&&m.has(x)){if(_.length<v.length){var ne=v[0],re;h=ne.prev;var ie=_[0],ae=_[_.length-1];for(re=0;re<_.length;re+=1)oi(_[re],ne,i);for(re=0;re<v.length;re+=1)m.delete(v[re]);si(n,ie.prev,ae.next),si(n,h,ie),si(n,ae,ne),p=ne,h=ae,--S,_=[],v=[]}else m.delete(x),oi(x,p,i),si(n,x.prev,x.next),si(n,x,h===null?n.first:h.next),si(n,h,x),h=x;continue}for(_=[],v=[];p!==null&&p.k!==b;)p.e.f&8192||(m??=new Set).add(p),v.push(p),p=p.next;if(p===null)continue;x=p}_.push(x),h=x,p=x.next}if(p!==null||m!==void 0){for(var oe=m===void 0?[]:Oe(m);p!==null;)p.e.f&8192||oe.push(p),p=p.next;var se=oe.length;if(se>0){var ce=o&4&&d===0?i:null;if(l){for(S=0;S<se;S+=1)oe[S].a?.measure();for(S=0;S<se;S+=1)oe[S].a?.fix()}ti(n,oe,ce)}}l&&wt(()=>{if(g!==void 0)for(x of g)x.a?.apply()}),e.first=n.first&&n.first.e,e.last=h&&h.e;for(var w of r.values())B(w.e);r.clear()}function ii(e,t,n,r){r&1&&un(e.v,t),r&2?un(e.i,n):e.i=n}function ai(e,t,n,r,i,a,o,s,c,l,u){var d=$r,f=(c&1)!=0,p=(c&16)==0,m=f?p?ln(i,!1,!1):cn(i):i,h=c&2?cn(o):o,g={i:h,v:m,k:a,a:null,e:null,prev:n,next:r};$r=g;try{return e===null&&document.createDocumentFragment().append(e=xn()),g.e=z(()=>s(e,m,h,l),D),g.e.prev=n&&n.e,g.e.next=r&&r.e,n===null?u||(t.first=g):(n.next=g,n.e.next=g.e),r!==null&&(r.prev=g,r.e.prev=g.e),g}finally{$r=d}}function oi(e,t,n){for(var r=e.next?e.next.e.nodes_start:n,i=t?t.e.nodes_start:n,a=e.e.nodes_start;a!==null&&a!==r;){var o=L(a);i.before(a),a=o}}function si(e,t,n){t===null?e.first=n:(t.next=n,t.e.next=n&&n.e),n!==null&&(n.prev=t,n.e.prev=t&&t.e)}function ci(e,t,n=!1,r=!1,i=!1){var a=e,o=``;Hn(()=>{var e=W;if(o===(o=t()??``)){D&&dt();return}if(e.nodes_start!==null&&(qn(e.nodes_start,e.nodes_end),e.nodes_start=e.nodes_end=null),o!==``){if(D){for(var i=O.data,s=dt(),c=s;s!==null&&(s.nodeType!==8||s.data!==``);)c=s,s=L(s);if(s===null)throw st(),ot;X(O,c),a=k(s);return}var l=o+``;n?l=`<svg>${l}</svg>`:r&&(l=`<math>${l}</math>`);var u=zr(l);if((n||r)&&(u=I(u)),X(I(u),u.lastChild),n||r)for(;I(u);)a.before(I(u));else a.before(u)}})}function li(e,t){zn(()=>{var n=e.getRootNode(),r=n.host?n:n.head??n.ownerDocument.head;if(!r.querySelector(`#`+t.hash)){let e=document.createElement(`style`);e.id=t.hash,e.textContent=t.code,r.appendChild(e)}})}function ui(e,t){var n=void 0,r;Un(()=>{n!==(n=t())&&(r&&=(B(r),null),n&&(r=z(()=>{zn(()=>n(e))})))})}function di(e){var t,n,r=``;if(typeof e==`string`||typeof e==`number`)r+=e;else if(typeof e==`object`)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=di(e[t]))&&(r&&(r+=` `),r+=n)}else for(n in e)e[n]&&(r&&(r+=` `),r+=n);return r}function fi(){for(var e,t,n=0,r=``,i=arguments.length;n<i;n++)(e=arguments[n])&&(t=di(e))&&(r&&(r+=` `),r+=t);return r}function pi(e){return typeof e==`object`?fi(e):e??``}var mi=[...` 	
\r\f\xA0\v﻿`];function hi(e,t,n){var r=e==null?``:``+e;if(t&&(r=r?r+` `+t:t),n){for(var i in n)if(n[i])r=r?r+` `+i:i;else if(r.length)for(var a=i.length,o=0;(o=r.indexOf(i,o))>=0;){var s=o+a;(o===0||mi.includes(r[o-1]))&&(s===r.length||mi.includes(r[s]))?r=(o===0?``:r.substring(0,o))+r.substring(s+1):o=s}}return r===``?null:r}function gi(e,t=!1){var n=t?` !important;`:`;`,r=``;for(var i in e){var a=e[i];a!=null&&a!==``&&(r+=` `+i+`: `+a+n)}return r}function _i(e){return e[0]!==`-`||e[1]!==`-`?e.toLowerCase():e}function vi(e,t){if(t){var n=``,r,i;if(Array.isArray(t)?(r=t[0],i=t[1]):r=t,e){e=String(e).replaceAll(/\s*\/\*.*?\*\/\s*/g,``).trim();var a=!1,o=0,s=!1,c=[];r&&c.push(...Object.keys(r).map(_i)),i&&c.push(...Object.keys(i).map(_i));var l=0,u=-1;let t=e.length;for(var d=0;d<t;d++){var f=e[d];if(s?f===`/`&&e[d-1]===`*`&&(s=!1):a?a===f&&(a=!1):f===`/`&&e[d+1]===`*`?s=!0:f===`"`||f===`'`?a=f:f===`(`?o++:f===`)`&&o--,!s&&a===!1&&o===0){if(f===`:`&&u===-1)u=d;else if(f===`;`||d===t-1){if(u!==-1){var p=_i(e.substring(l,u).trim());if(!c.includes(p)){f!==`;`&&d++;var m=e.substring(l,d).trim();n+=` `+m+`;`}}l=d+1,u=-1}}}}return r&&(n+=gi(r)),i&&(n+=gi(i,!0)),n=n.trim(),n===``?null:n}return e==null?null:String(e)}function yi(e,t,n,r,i,a){var o=e.__className;if(D||o!==n||o===void 0){var s=hi(n,r,a);(!D||s!==e.getAttribute(`class`))&&(s==null?e.removeAttribute(`class`):t?e.className=s:e.setAttribute(`class`,s)),e.__className=n}else if(a&&i!==a)for(var c in a){var l=!!a[c];(i==null||l!==!!i[c])&&e.classList.toggle(c,l)}return a}function bi(e,t={},n,r){for(var i in n){var a=n[i];t[i]!==a&&(n[i]==null?e.style.removeProperty(i):e.style.setProperty(i,a,r))}}function xi(e,t,n,r){var i=e.__style;if(D||i!==t){var a=vi(t,r);(!D||a!==e.getAttribute(`style`))&&(a==null?e.removeAttribute(`style`):e.style.cssText=a),e.__style=t}else r&&(Array.isArray(r)?(bi(e,n?.[0],r[0]),bi(e,n?.[1],r[1],`important`)):bi(e,n,r));return r}function Si(e,t,n=!1){if(e.multiple){if(t==null)return;if(!Ee(t))return ct();for(var r of e.options)r.selected=t.includes(wi(r));return}for(r of e.options){var i=wi(r);if(hn(i,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Ci(e){var t=new MutationObserver(()=>{Si(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[`value`]}),Fn(()=>{t.disconnect()})}function wi(e){return`__value`in e?e.__value:e.value}let Ti=Symbol(`class`),Ei=Symbol(`style`);var Di=Symbol(`is custom element`),Oi=Symbol(`is html`);function ki(e){if(D){var t=!1,n=()=>{if(!t){if(t=!0,e.hasAttribute(`value`)){var n=e.value;Z(e,`value`,null),e.value=n}if(e.hasAttribute(`checked`)){var r=e.checked;Z(e,`checked`,null),e.checked=r}}};e.__on_r=n,wt(n),On()}}function Ai(e,t){t?e.hasAttribute(`selected`)||e.setAttribute(`selected`,``):e.removeAttribute(`selected`)}function Z(e,t,n,r){var i=Ni(e);D&&(i[t]=e.getAttribute(t),t===`src`||t===`srcset`||t===`href`&&e.nodeName===`LINK`)||i[t]!==(i[t]=n)&&(t===`loading`&&(e[Je]=n),n==null?e.removeAttribute(t):typeof n!=`string`&&Fi(e).includes(t)?e[t]=n:e.setAttribute(t,n))}function ji(e,t,n,r,i=!1,a=!1){if(D&&i&&e.tagName===`INPUT`){var o=e;(o.type===`checkbox`?`defaultChecked`:`defaultValue`)in n||ki(o)}var s=Ni(e),c=s[Di],l=!s[Oi];let u=D&&c;u&&ut(!1);var d=t||{},f=e.tagName===`OPTION`;for(var p in t)p in n||(n[p]=null);n.class?n.class=pi(n.class):(r||n[Ti])&&(n.class=null),n[Ei]&&(n.style??=null);var m=Fi(e);for(let i in n){let o=n[i];if(f&&i===`value`&&o==null){e.value=e.__value=``,d[i]=o;continue}if(i===`class`){var h=e.namespaceURI===`http://www.w3.org/1999/xhtml`;yi(e,h,o,r,t?.[Ti],n[Ti]),d[i]=o,d[Ti]=n[Ti];continue}if(i===`style`){xi(e,o,t?.[Ei],n[Ei]),d[i]=o,d[Ei]=n[Ei];continue}var g=d[i];if(!(o===g&&!(o===void 0&&e.hasAttribute(i)))){d[i]=o;var _=i[0]+i[1];if(_!==`$$`)if(_===`on`){let t={},n=`$$`+i,r=i.slice(2);var v=Dr(r);if(Tr(r)&&(r=r.slice(0,-7),t.capture=!0),!v&&g){if(o!=null)continue;e.removeEventListener(r,d[n],t),d[n]=null}if(o!=null)if(v)e[`__${r}`]=o,Ir([r]);else{function a(e){d[i].call(this,e)}d[n]=Fr(r,e,a,t)}else v&&(e[`__${r}`]=void 0)}else if(i===`style`)Z(e,i,o);else if(i===`autofocus`)En(e,!!o);else if(!c&&(i===`__value`||i===`value`&&o!=null))e.value=e.__value=o;else if(i===`selected`&&f)Ai(e,o);else{var y=i;l||(y=Ar(y));var b=y===`defaultValue`||y===`defaultChecked`;if(o==null&&!c&&!b)if(s[i]=null,y===`value`||y===`checked`){let n=e,r=t===void 0;if(y===`value`){let e=n.defaultValue;n.removeAttribute(y),n.defaultValue=e,n.value=n.__value=r?e:null}else{let e=n.defaultChecked;n.removeAttribute(y),n.defaultChecked=e,n.checked=r?e:!1}}else e.removeAttribute(i);else b||m.includes(y)&&(c||typeof o!=`string`)?(e[y]=o,y in s&&(s[y]=E)):typeof o!=`function`&&Z(e,y,o,a)}}}return u&&ut(!0),d}function Mi(e,t,n=[],r=[],i,a=!1,o=!1){Xt(n,r,n=>{var r=void 0,s={},c=e.nodeName===`SELECT`,l=!1;if(Un(()=>{var u=t(...n.map(J)),d=ji(e,r,u,i,a,o);l&&c&&`value`in u&&Si(e,u.value);for(let e of Object.getOwnPropertySymbols(s))u[e]||B(s[e]);for(let t of Object.getOwnPropertySymbols(u)){var f=u[t];t.description===`@attach`&&(!r||f!==r[t])&&(s[t]&&B(s[t]),s[t]=z(()=>ui(e,()=>f))),d[t]=f}r=d}),c){var u=e;zn(()=>{Si(u,r.value,!0),Ci(u)})}l=!0})}function Ni(e){return e.__attributes??={[Di]:e.nodeName.includes(`-`),[Oi]:e.namespaceURI===`http://www.w3.org/1999/xhtml`}}var Pi=new Map;function Fi(e){var t=e.getAttribute(`is`)||e.nodeName,n=Pi.get(t);if(n)return n;Pi.set(t,n=[]);for(var r,i=e,a=Element.prototype;a!==i;){for(var o in r=je(i),r)r[o].set&&n.push(o);i=Pe(i)}return n}var Ii=()=>performance.now();let Li={tick:e=>requestAnimationFrame(e),now:()=>Ii(),tasks:new Set};function Ri(){let e=Li.now();Li.tasks.forEach(t=>{t.c(e)||(Li.tasks.delete(t),t.f())}),Li.tasks.size!==0&&Li.tick(Ri)}function zi(e){let t;return Li.tasks.size===0&&Li.tick(Ri),{promise:new Promise(n=>{Li.tasks.add(t={c:e,f:n})}),abort(){Li.tasks.delete(t)}}}function Bi(e,t){kn(()=>{e.dispatchEvent(new CustomEvent(t))})}function Vi(e){if(e===`float`)return`cssFloat`;if(e===`offset`)return`cssOffset`;if(e.startsWith(`--`))return e;let t=e.split(`-`);return t.length===1?t[0]:t[0]+t.slice(1).map(e=>e[0].toUpperCase()+e.slice(1)).join(``)}function Hi(e){let t={},n=e.split(`;`);for(let e of n){let[n,r]=e.split(`:`);if(!n||r===void 0)break;let i=Vi(n.trim());t[i]=r.trim()}return t}var Ui=e=>e;function Wi(e,t,n,r){var i=(e&1)!=0,a=(e&2)!=0,o=i&&a,s=(e&4)!=0,c=o?`both`:i?`in`:`out`,l,u=t.inert,d=t.style.overflow,f,p;function m(){return kn(()=>l??=n()(t,r?.()??{},{direction:c}))}var h={is_global:s,in(){if(t.inert=u,!i){p?.abort(),p?.reset?.();return}a||f?.abort(),Bi(t,`introstart`),f=Gi(t,m(),p,1,()=>{Bi(t,`introend`),f?.abort(),f=l=void 0,t.style.overflow=d})},out(e){if(!a){e?.(),l=void 0;return}t.inert=!0,Bi(t,`outrostart`),p=Gi(t,m(),f,0,()=>{Bi(t,`outroend`),e?.()})},stop:()=>{f?.abort(),p?.abort()}},g=W;if((g.transitions??=[]).push(h),i&&Gr){var _=s;if(!_){for(var v=g.parent;v&&v.f&65536;)for(;(v=v.parent)&&!(v.f&16););_=!v||(v.f&32768)!=0}_&&zn(()=>{Cr(()=>h.in())})}}function Gi(e,t,n,r,i){var a=r===1;if(Ie(t)){var o,s=!1;return wt(()=>{if(!s){var c=t({direction:a?`in`:`out`});o=Gi(e,c,n,r,i)}}),{abort:()=>{s=!0,o?.abort()},deactivate:()=>o.deactivate(),reset:()=>o.reset(),t:()=>o.t()}}if(n?.deactivate(),!t?.duration)return i(),{abort:Le,deactivate:Le,reset:Le,t:()=>r};let{delay:c=0,css:l,tick:u,easing:d=Ui}=t;var f=[];if(a&&n===void 0&&(u&&u(0,1),l)){var p=Hi(l(0,1));f.push(p,p)}var m=()=>1-r,h=e.animate(f,{duration:c,fill:`forwards`});return h.onfinish=()=>{h.cancel();var a=n?.t()??1-r;n?.abort();var o=r-a,s=t.duration*Math.abs(o),c=[];if(s>0){var f=!1;if(l)for(var p=Math.ceil(s/(1e3/60)),g=0;g<=p;g+=1){var _=a+o*d(g/p),v=Hi(l(_,1-_));c.push(v),f||=v.overflow===`hidden`}f&&(e.style.overflow=`hidden`),m=()=>{var e=h.currentTime;return a+o*d(e/s)},u&&zi(()=>{if(h.playState!==`running`)return!1;var e=m();return u(e,1-e),!0})}h=e.animate(c,{duration:s,fill:`forwards`}),h.onfinish=()=>{m=()=>r,u?.(r,1-r),i()}},{abort:()=>{h&&(h.cancel(),h.effect=null,h.onfinish=Le)},deactivate:()=>{i=Le},reset:()=>{r===0&&u?.(1,0)},t:()=>m()}}function Ki(e,t,n=t){var r=new WeakSet;An(e,`input`,async i=>{var a=i?e.defaultValue:e.value;if(a=qi(e)?Ji(a):a,n(a),M!==null&&r.add(M),await xr(),a!==(a=t())){var o=e.selectionStart,s=e.selectionEnd,c=e.value.length;if(e.value=a??``,s!==null){var l=e.value.length;o===s&&s===c&&l>c?(e.selectionStart=l,e.selectionEnd=l):(e.selectionStart=o,e.selectionEnd=Math.min(s,l))}}}),(D&&e.defaultValue!==e.value||Cr(t)==null&&e.value)&&(n(qi(e)?Ji(e.value):e.value),M!==null&&r.add(M)),Vn(()=>{var n=t();if(e===document.activeElement){var i=jt??M;if(r.has(i))return}qi(e)&&n===Ji(e.value)||e.type===`date`&&!n&&!e.value||n!==e.value&&(e.value=n??``)})}function qi(e){var t=e.type;return t===`number`||t===`range`}function Ji(e){return e===``?null:+e}function Yi(e,t){return e===t||e?.[qe]===t}function Xi(e={},t,n,r){return zn(()=>{var i,a;return Vn(()=>{i=a,a=r?.()||[],Cr(()=>{e!==n(...a)&&(t(e,...a),i&&Yi(n(...i),e)&&t(null,...i))})}),()=>{wt(()=>{a&&Yi(n(...a),e)&&t(null,...a)})}}),e}var Zi={get(e,t){if(!e.exclude.includes(t))return e.props[t]},set(e,t){return!1},getOwnPropertyDescriptor(e,t){if(!e.exclude.includes(t)&&t in e.props)return{enumerable:!0,configurable:!0,value:e.props[t]}},has(e,t){return e.exclude.includes(t)?!1:t in e.props},ownKeys(e){return Reflect.ownKeys(e.props).filter(t=>!e.exclude.includes(t))}};function Qi(e,t,n){return new Proxy({props:e,exclude:t},Zi)}function $i(e){j===null&&Xe(`onMount`),In(()=>{let t=Cr(e);if(typeof t==`function`)return t})}function ea(e){j===null&&Xe(`onDestroy`),$i(()=>()=>Cr(e))}typeof window<`u`&&((window.__svelte??={}).v??=new Set).add(`5`);var ta=e=>e;function na(e){let t=e-1;return t*t*t+1}function ra(e){let t=typeof e==`string`&&e.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return t?[parseFloat(t[1]),t[2]||`px`]:[e,`px`]}function ia(e,{delay:t=0,duration:n=400,easing:r=ta}={}){let i=+getComputedStyle(e).opacity;return{delay:t,duration:n,easing:r,css:e=>`opacity: ${e*i}`}}function aa(e,{delay:t=0,duration:n=400,easing:r=na,x:i=0,y:a=0,opacity:o=0}={}){let s=getComputedStyle(e),c=+s.opacity,l=s.transform===`none`?``:s.transform,u=c*(1-o),[d,f]=ra(i),[p,m]=ra(a);return{delay:t,duration:n,easing:r,css:(e,t)=>`
			transform: ${l} translate(${(1-e)*d}${f}, ${(1-e)*p}${m});
			opacity: ${c-u*t}`}}function oa(e){return Array.isArray?Array.isArray(e):ga(e)===`[object Array]`}var sa=1/0;function ca(e){if(typeof e==`string`)return e;let t=e+``;return t==`0`&&1/e==-sa?`-0`:t}function la(e){return e==null?``:ca(e)}function ua(e){return typeof e==`string`}function da(e){return typeof e==`number`}function fa(e){return e===!0||e===!1||ma(e)&&ga(e)==`[object Boolean]`}function pa(e){return typeof e==`object`}function ma(e){return pa(e)&&e!==null}function Q(e){return e!=null}function ha(e){return!e.trim().length}function ga(e){return e==null?e===void 0?`[object Undefined]`:`[object Null]`:Object.prototype.toString.call(e)}var _a=`Incorrect 'index' type`,va=e=>`Invalid value for key ${e}`,ya=e=>`Pattern length exceeds max of ${e}.`,ba=e=>`Missing ${e} property in key`,xa=e=>`Property 'weight' in key '${e}' must be a positive integer`,Sa=Object.prototype.hasOwnProperty,Ca=class{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(e=>{let n=wa(e);this._keys.push(n),this._keyMap[n.id]=n,t+=n.weight}),this._keys.forEach(e=>{e.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}};function wa(e){let t=null,n=null,r=null,i=1,a=null;if(ua(e)||oa(e))r=e,t=Ta(e),n=Ea(e);else{if(!Sa.call(e,`name`))throw Error(ba(`name`));let o=e.name;if(r=o,Sa.call(e,`weight`)&&(i=e.weight,i<=0))throw Error(xa(o));t=Ta(o),n=Ea(o),a=e.getFn}return{path:t,id:n,weight:i,src:r,getFn:a}}function Ta(e){return oa(e)?e:e.split(`.`)}function Ea(e){return oa(e)?e.join(`.`):e}function Da(e,t){let n=[],r=!1,i=(e,t,a)=>{if(Q(e))if(!t[a])n.push(e);else{let o=t[a],s=e[o];if(!Q(s))return;if(a===t.length-1&&(ua(s)||da(s)||fa(s)))n.push(la(s));else if(oa(s)){r=!0;for(let e=0,n=s.length;e<n;e+=1)i(s[e],t,a+1)}else t.length&&i(s,t,a+1)}};return i(e,ua(t)?t.split(`.`):t,0),r?n:n[0]}var Oa={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},ka={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(e,t)=>e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1},Aa={location:0,threshold:.6,distance:100},ja={useExtendedSearch:!1,getFn:Da,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},$={...ka,...Oa,...Aa,...ja},Ma=/[^ ]+/g;function Na(e=1,t=3){let n=new Map,r=10**t;return{get(t){let i=t.match(Ma).length;if(n.has(i))return n.get(i);let a=1/i**(.5*e),o=parseFloat(Math.round(a*r)/r);return n.set(i,o),o},clear(){n.clear()}}}var Pa=class{constructor({getFn:e=$.getFn,fieldNormWeight:t=$.fieldNormWeight}={}){this.norm=Na(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((e,t)=>{this._keysMap[e.id]=t})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,ua(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){let t=this.size();ua(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)--this.records[t].i}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!Q(e)||ha(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach((t,r)=>{let i=t.getFn?t.getFn(e):this.getFn(e,t.path);if(Q(i)){if(oa(i)){let e=[],t=[{nestedArrIndex:-1,value:i}];for(;t.length;){let{nestedArrIndex:n,value:r}=t.pop();if(Q(r))if(ua(r)&&!ha(r)){let t={v:r,i:n,n:this.norm.get(r)};e.push(t)}else oa(r)&&r.forEach((e,n)=>{t.push({nestedArrIndex:n,value:e})})}n.$[r]=e}else if(ua(i)&&!ha(i)){let e={v:i,n:this.norm.get(i)};n.$[r]=e}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}};function Fa(e,t,{getFn:n=$.getFn,fieldNormWeight:r=$.fieldNormWeight}={}){let i=new Pa({getFn:n,fieldNormWeight:r});return i.setKeys(e.map(wa)),i.setSources(t),i.create(),i}function Ia(e,{getFn:t=$.getFn,fieldNormWeight:n=$.fieldNormWeight}={}){let{keys:r,records:i}=e,a=new Pa({getFn:t,fieldNormWeight:n});return a.setKeys(r),a.setIndexRecords(i),a}function La(e,{errors:t=0,currentLocation:n=0,expectedLocation:r=0,distance:i=$.distance,ignoreLocation:a=$.ignoreLocation}={}){let o=t/e.length;if(a)return o;let s=Math.abs(r-n);return i?o+s/i:s?1:o}function Ra(e=[],t=$.minMatchCharLength){let n=[],r=-1,i=-1,a=0;for(let o=e.length;a<o;a+=1){let o=e[a];o&&r===-1?r=a:!o&&r!==-1&&(i=a-1,i-r+1>=t&&n.push([r,i]),r=-1)}return e[a-1]&&a-r>=t&&n.push([r,a-1]),n}var za=32;function Ba(e,t,n,{location:r=$.location,distance:i=$.distance,threshold:a=$.threshold,findAllMatches:o=$.findAllMatches,minMatchCharLength:s=$.minMatchCharLength,includeMatches:c=$.includeMatches,ignoreLocation:l=$.ignoreLocation}={}){if(t.length>za)throw Error(ya(za));let u=t.length,d=e.length,f=Math.max(0,Math.min(r,d)),p=a,m=f,h=s>1||c,g=h?Array(d):[],_;for(;(_=e.indexOf(t,m))>-1;){let e=La(t,{currentLocation:_,expectedLocation:f,distance:i,ignoreLocation:l});if(p=Math.min(e,p),m=_+u,h){let e=0;for(;e<u;)g[_+e]=1,e+=1}}m=-1;let v=[],y=1,b=u+d,x=1<<u-1;for(let r=0;r<u;r+=1){let a=0,s=b;for(;a<s;)La(t,{errors:r,currentLocation:f+s,expectedLocation:f,distance:i,ignoreLocation:l})<=p?a=s:b=s,s=Math.floor((b-a)/2+a);b=s;let c=Math.max(1,f-s+1),_=o?d:Math.min(f+s,d)+u,S=Array(_+2);S[_+1]=(1<<r)-1;for(let a=_;a>=c;--a){let o=a-1,s=n[e.charAt(o)];if(h&&(g[o]=+!!s),S[a]=(S[a+1]<<1|1)&s,r&&(S[a]|=(v[a+1]|v[a])<<1|1|v[a+1]),S[a]&x&&(y=La(t,{errors:r,currentLocation:o,expectedLocation:f,distance:i,ignoreLocation:l}),y<=p)){if(p=y,m=o,m<=f)break;c=Math.max(1,2*f-m)}}if(La(t,{errors:r+1,currentLocation:f,expectedLocation:f,distance:i,ignoreLocation:l})>p)break;v=S}let S={isMatch:m>=0,score:Math.max(.001,y)};if(h){let e=Ra(g,s);e.length?c&&(S.indices=e):S.isMatch=!1}return S}function Va(e){let t={};for(let n=0,r=e.length;n<r;n+=1){let i=e.charAt(n);t[i]=(t[i]||0)|1<<r-n-1}return t}var Ha=String.prototype.normalize?(e=>e.normalize(`NFD`).replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,``)):(e=>e),Ua=class{constructor(e,{location:t=$.location,threshold:n=$.threshold,distance:r=$.distance,includeMatches:i=$.includeMatches,findAllMatches:a=$.findAllMatches,minMatchCharLength:o=$.minMatchCharLength,isCaseSensitive:s=$.isCaseSensitive,ignoreDiacritics:c=$.ignoreDiacritics,ignoreLocation:l=$.ignoreLocation}={}){if(this.options={location:t,threshold:n,distance:r,includeMatches:i,findAllMatches:a,minMatchCharLength:o,isCaseSensitive:s,ignoreDiacritics:c,ignoreLocation:l},e=s?e:e.toLowerCase(),e=c?Ha(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;let u=(e,t)=>{this.chunks.push({pattern:e,alphabet:Va(e),startIndex:t})},d=this.pattern.length;if(d>za){let e=0,t=d%za,n=d-t;for(;e<n;)u(this.pattern.substr(e,za),e),e+=za;if(t){let e=d-za;u(this.pattern.substr(e),e)}}else u(this.pattern,0)}searchIn(e){let{isCaseSensitive:t,ignoreDiacritics:n,includeMatches:r}=this.options;if(e=t?e:e.toLowerCase(),e=n?Ha(e):e,this.pattern===e){let t={isMatch:!0,score:0};return r&&(t.indices=[[0,e.length-1]]),t}let{location:i,distance:a,threshold:o,findAllMatches:s,minMatchCharLength:c,ignoreLocation:l}=this.options,u=[],d=0,f=!1;this.chunks.forEach(({pattern:t,alphabet:n,startIndex:p})=>{let{isMatch:m,score:h,indices:g}=Ba(e,t,n,{location:i+p,distance:a,threshold:o,findAllMatches:s,minMatchCharLength:c,includeMatches:r,ignoreLocation:l});m&&(f=!0),d+=h,m&&g&&(u=[...u,...g])});let p={isMatch:f,score:f?d/this.chunks.length:1};return f&&r&&(p.indices=u),p}},Wa=class{constructor(e){this.pattern=e}static isMultiMatch(e){return Ga(e,this.multiRegex)}static isSingleMatch(e){return Ga(e,this.singleRegex)}search(){}};function Ga(e,t){let n=e.match(t);return n?n[1]:null}var Ka=class extends Wa{constructor(e){super(e)}static get type(){return`exact`}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){let t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},qa=class extends Wa{constructor(e){super(e)}static get type(){return`inverse-exact`}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){let t=e.indexOf(this.pattern)===-1;return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},Ja=class extends Wa{constructor(e){super(e)}static get type(){return`prefix-exact`}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){let t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}},Ya=class extends Wa{constructor(e){super(e)}static get type(){return`inverse-prefix-exact`}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){let t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},Xa=class extends Wa{constructor(e){super(e)}static get type(){return`suffix-exact`}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){let t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}},Za=class extends Wa{constructor(e){super(e)}static get type(){return`inverse-suffix-exact`}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){let t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}},Qa=class extends Wa{constructor(e,{location:t=$.location,threshold:n=$.threshold,distance:r=$.distance,includeMatches:i=$.includeMatches,findAllMatches:a=$.findAllMatches,minMatchCharLength:o=$.minMatchCharLength,isCaseSensitive:s=$.isCaseSensitive,ignoreDiacritics:c=$.ignoreDiacritics,ignoreLocation:l=$.ignoreLocation}={}){super(e),this._bitapSearch=new Ua(e,{location:t,threshold:n,distance:r,includeMatches:i,findAllMatches:a,minMatchCharLength:o,isCaseSensitive:s,ignoreDiacritics:c,ignoreLocation:l})}static get type(){return`fuzzy`}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}},$a=class extends Wa{constructor(e){super(e)}static get type(){return`include`}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,n,r=[],i=this.pattern.length;for(;(n=e.indexOf(this.pattern,t))>-1;)t=n+i,r.push([n,t-1]);let a=!!r.length;return{isMatch:a,score:a?0:1,indices:r}}},eo=[Ka,$a,Ja,Ya,Za,Xa,qa,Qa],to=eo.length,no=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,ro=`|`;function io(e,t={}){return e.split(ro).map(e=>{let n=e.trim().split(no).filter(e=>e&&!!e.trim()),r=[];for(let e=0,i=n.length;e<i;e+=1){let i=n[e],a=!1,o=-1;for(;!a&&++o<to;){let e=eo[o],n=e.isMultiMatch(i);n&&(r.push(new e(n,t)),a=!0)}if(!a)for(o=-1;++o<to;){let e=eo[o],n=e.isSingleMatch(i);if(n){r.push(new e(n,t));break}}}return r})}var ao=new Set([Qa.type,$a.type]),oo=class{constructor(e,{isCaseSensitive:t=$.isCaseSensitive,ignoreDiacritics:n=$.ignoreDiacritics,includeMatches:r=$.includeMatches,minMatchCharLength:i=$.minMatchCharLength,ignoreLocation:a=$.ignoreLocation,findAllMatches:o=$.findAllMatches,location:s=$.location,threshold:c=$.threshold,distance:l=$.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:n,includeMatches:r,minMatchCharLength:i,findAllMatches:o,ignoreLocation:a,location:s,threshold:c,distance:l},e=t?e:e.toLowerCase(),e=n?Ha(e):e,this.pattern=e,this.query=io(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){let t=this.query;if(!t)return{isMatch:!1,score:1};let{includeMatches:n,isCaseSensitive:r,ignoreDiacritics:i}=this.options;e=r?e:e.toLowerCase(),e=i?Ha(e):e;let a=0,o=[],s=0;for(let r=0,i=t.length;r<i;r+=1){let i=t[r];o.length=0,a=0;for(let t=0,r=i.length;t<r;t+=1){let r=i[t],{isMatch:c,indices:l,score:u}=r.search(e);if(c){if(a+=1,s+=u,n){let e=r.constructor.type;ao.has(e)?o=[...o,...l]:o.push(l)}}else{s=0,a=0,o.length=0;break}}if(a){let e={isMatch:!0,score:s/a};return n&&(e.indices=o),e}}return{isMatch:!1,score:1}}},so=[];function co(...e){so.push(...e)}function lo(e,t){for(let n=0,r=so.length;n<r;n+=1){let r=so[n];if(r.condition(e,t))return new r(e,t)}return new Ua(e,t)}var uo={AND:`$and`,OR:`$or`},fo={PATH:`$path`,PATTERN:`$val`},po=e=>!!(e[uo.AND]||e[uo.OR]),mo=e=>!!e[fo.PATH],ho=e=>!oa(e)&&pa(e)&&!po(e),go=e=>({[uo.AND]:Object.keys(e).map(t=>({[t]:e[t]}))});function _o(e,t,{auto:n=!0}={}){let r=e=>{let i=Object.keys(e),a=mo(e);if(!a&&i.length>1&&!po(e))return r(go(e));if(ho(e)){let r=a?e[fo.PATH]:i[0],o=a?e[fo.PATTERN]:e[r];if(!ua(o))throw Error(va(r));let s={keyId:Ea(r),pattern:o};return n&&(s.searcher=lo(o,t)),s}let o={children:[],operator:i[0]};return i.forEach(t=>{let n=e[t];oa(n)&&n.forEach(e=>{o.children.push(r(e))})}),o};return po(e)||(e=go(e)),r(e)}function vo(e,{ignoreFieldNorm:t=$.ignoreFieldNorm}){e.forEach(e=>{let n=1;e.matches.forEach(({key:e,norm:r,score:i})=>{let a=e?e.weight:null;n*=(i===0&&a?2**-52:i)**+((a||1)*(t?1:r))}),e.score=n})}function yo(e,t){let n=e.matches;t.matches=[],Q(n)&&n.forEach(e=>{if(!Q(e.indices)||!e.indices.length)return;let{indices:n,value:r}=e,i={indices:n,value:r};e.key&&(i.key=e.key.src),e.idx>-1&&(i.refIndex=e.idx),t.matches.push(i)})}function bo(e,t){t.score=e.score}function xo(e,t,{includeMatches:n=$.includeMatches,includeScore:r=$.includeScore}={}){let i=[];return n&&i.push(yo),r&&i.push(bo),e.map(e=>{let{idx:n}=e,r={item:t[n],refIndex:n};return i.length&&i.forEach(t=>{t(e,r)}),r})}var So=class{constructor(e,t={},n){this.options={...$,...t},this.options.useExtendedSearch,this._keyStore=new Ca(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof Pa))throw Error(_a);this._myIndex=t||Fa(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){Q(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){let t=[];for(let n=0,r=this._docs.length;n<r;n+=1){let i=this._docs[n];e(i,n)&&(this.removeAt(n),--n,--r,t.push(i))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){let{includeMatches:n,includeScore:r,shouldSort:i,sortFn:a,ignoreFieldNorm:o}=this.options,s=ua(e)?ua(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return vo(s,{ignoreFieldNorm:o}),i&&s.sort(a),da(t)&&t>-1&&(s=s.slice(0,t)),xo(s,this._docs,{includeMatches:n,includeScore:r})}_searchStringList(e){let t=lo(e,this.options),{records:n}=this._myIndex,r=[];return n.forEach(({v:e,i:n,n:i})=>{if(!Q(e))return;let{isMatch:a,score:o,indices:s}=t.searchIn(e);a&&r.push({item:e,idx:n,matches:[{score:o,value:e,norm:i,indices:s}]})}),r}_searchLogical(e){let t=_o(e,this.options),n=(e,t,r)=>{if(!e.children){let{keyId:n,searcher:i}=e,a=this._findMatches({key:this._keyStore.get(n),value:this._myIndex.getValueForItemAtKeyId(t,n),searcher:i});return a&&a.length?[{idx:r,item:t,matches:a}]:[]}let i=[];for(let a=0,o=e.children.length;a<o;a+=1){let o=e.children[a],s=n(o,t,r);if(s.length)i.push(...s);else if(e.operator===uo.AND)return[]}return i},r=this._myIndex.records,i={},a=[];return r.forEach(({$:e,i:r})=>{if(Q(e)){let o=n(t,e,r);o.length&&(i[r]||(i[r]={idx:r,item:e,matches:[]},a.push(i[r])),o.forEach(({matches:e})=>{i[r].matches.push(...e)}))}}),a}_searchObjectList(e){let t=lo(e,this.options),{keys:n,records:r}=this._myIndex,i=[];return r.forEach(({$:e,i:r})=>{if(!Q(e))return;let a=[];n.forEach((n,r)=>{a.push(...this._findMatches({key:n,value:e[r],searcher:t}))}),a.length&&i.push({idx:r,item:e,matches:a})}),i}_findMatches({key:e,value:t,searcher:n}){if(!Q(t))return[];let r=[];if(oa(t))t.forEach(({v:t,i,n:a})=>{if(!Q(t))return;let{isMatch:o,score:s,indices:c}=n.searchIn(t);o&&r.push({score:s,key:e,value:t,idx:i,norm:a,indices:c})});else{let{v:i,n:a}=t,{isMatch:o,score:s,indices:c}=n.searchIn(i);o&&r.push({score:s,key:e,value:i,norm:a,indices:c})}return r}};So.version=`7.1.0`,So.createIndex=Fa,So.parseIndex=Ia,So.config=$,So.parseQuery=_o,co(oo);let Co=new class{constructor(){this.fuse=null,this.searchableData=[]}async initializeIndex(){console.info(`[Search] Initializing search index...`);let[e,t]=await Promise.all([T.getAllThreads(),T.getAllMessages()]);this.searchableData=[];for(let n of t){let t=e.find(e=>e.id===n.threadId);if(t)for(let e of n.messages){let n=``;e.content&&typeof e.content==`string`&&(n=e.content),n.trim()&&this.searchableData.push({threadId:t.id,threadName:t.name,messageId:e.id,messageContent:n,messageRole:e.role,createdAt:e.createdAt})}}this.fuse=new So(this.searchableData,{keys:[{name:`messageContent`,weight:.7},{name:`threadName`,weight:.3}],threshold:.4,includeScore:!0,includeMatches:!0,minMatchCharLength:2,ignoreLocation:!0}),console.info(`[Search] Index initialized with ${this.searchableData.length} messages`)}search(e,t=20){return!this.fuse||!e.trim()?[]:this.fuse.search(e,{limit:t}).map(e=>{let t=e.item,n=t.messageContent;if(e.matches&&e.matches.length>0){let t=e.matches[0];if(t.indices&&t.indices.length>0){let[e,r]=t.indices[0],i=n.slice(e,r+1),a=Math.max(0,e-50),o=Math.min(n.length,r+50+1),s=a>0?`...`:``,c=o<n.length?`...`:``;n=s+n.slice(a,e)+`<mark>${i}</mark>`+n.slice(r+1,o)+c}}else n.length>200&&(n=n.slice(0,200)+`...`);return{threadId:t.threadId,threadName:t.threadName,messageId:t.messageId,messageContent:t.messageContent,messageRole:t.messageRole,createdAt:t.createdAt,highlightedContent:n}})}async reindex(){await this.initializeIndex()}};function wo(e,t,n,r){e.addEventListener(t,n,r),ea(()=>{e.removeEventListener(t,n,r)})}var To=Hr(`<svg><path fill="currentColor" d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5l-1.5 1.5l-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16A6.5 6.5 0 0 1 3 9.5A6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14S14 12 14 9.5S12 5 9.5 5"></path></svg>`);function Eo(e,t){let n=Qi(t,[`$$slots`,`$$events`,`$$legacy`]);var r=To();Mi(r,()=>({viewBox:`0 0 24 24`,width:`1.2em`,height:`1.2em`,...n})),Wr(e,r)}function Do(e,t,n,r){if(!J(t).trim()){F(n,[],!0),F(r,0);return}F(n,Co.search(J(t),20),!0),F(r,0)}function Oo(e,t,n,r,i,a,o){if(e.key===`Escape`){if(e.preventDefault(),J(t)){F(t,``),F(n,[],!0),F(r,0);return}i();return}if(e.key===`ArrowDown`){e.preventDefault(),J(n).length>0&&(F(r,(J(r)+1)%J(n).length),a());return}if(e.key===`ArrowUp`){e.preventDefault(),J(n).length>0&&(F(r,(J(r)-1+J(n).length)%J(n).length),a());return}if(e.key===`Enter`){e.preventDefault(),J(n).length>0&&J(r)>=0&&o(J(n)[J(r)]);return}}function ko(e,t){e.target===e.currentTarget&&t()}var Ao=Br(`<div class="search-empty svelte-1ocnzw1" role="status"><p>未找到匹配的结果</p></div>`),jo=(e,t,n)=>t(J(n)),Mo=(e,t,n)=>e.key===`Enter`&&t(J(n)),No=Br(`<li class="search-result-item svelte-1ocnzw1" role="option" tabindex="-1"><div class="result-header svelte-1ocnzw1"><span class="result-thread-name svelte-1ocnzw1"> </span> <span class="result-date svelte-1ocnzw1"> </span></div> <div class="result-content svelte-1ocnzw1"><!></div></li>`),Po=Br(`<ul id="search-results" class="search-results svelte-1ocnzw1" role="listbox" aria-label="搜索结果"></ul>`),Fo=Br(`<div class="search-backdrop svelte-1ocnzw1" role="presentation"><div class="search-dialog svelte-1ocnzw1" role="dialog" aria-modal="true" aria-labelledby="search-label"><div class="search-container svelte-1ocnzw1"><div class="search-input-wrapper svelte-1ocnzw1"><!> <label for="search-input" id="search-label" class="sr-only svelte-1ocnzw1">搜索聊天记录</label> <input id="search-input" type="text" class="search-input svelte-1ocnzw1" role="combobox" aria-autocomplete="list" aria-controls="search-results"/> <kbd class="search-shortcut svelte-1ocnzw1" aria-label="键盘快捷键">ESC</kbd></div> <!> <!> <div class="search-footer svelte-1ocnzw1"><div class="search-tips svelte-1ocnzw1"><kbd aria-label="向上箭头" class="svelte-1ocnzw1">↑</kbd> <kbd aria-label="向下箭头" class="svelte-1ocnzw1">↓</kbd> <span>导航</span> <kbd aria-label="回车键" class="svelte-1ocnzw1">↵</kbd> <span>选择</span> <kbd aria-label="Escape 键" class="svelte-1ocnzw1">ESC</kbd> <span>关闭</span></div> <div class="search-results-count svelte-1ocnzw1"> </div></div></div></div></div>`),Io={hash:`svelte-1ocnzw1`,code:`.search-backdrop.svelte-1ocnzw1 {
    /* Light theme colors */--backdrop-bg: rgba(0, 0, 0, 0.3);--dialog-bg: #ffffff;--dialog-border: #d4d4d4;--dialog-shadow: rgba(0, 0, 0, 0.2);--input-border: #e5e5e5;--icon-color: #616161;--text-primary: #1e1e1e;--text-secondary: #616161;--text-placeholder: #999999;--keybinding-bg: #f3f3f3;--keybinding-border: #cccccc;--keybinding-text: #424242;--hover-bg: #f9f9f9;--selected-bg: #e8e8e8;--highlight-bg: #ffff05;--highlight-text: #000000;--border-radius: 8px;}

  @media (prefers-color-scheme: dark) {.search-backdrop.svelte-1ocnzw1 {
      /* Dark theme colors */--backdrop-bg: rgba(0, 0, 0, 0.5);--dialog-bg: #252526;--dialog-border: #454545;--dialog-shadow: rgba(0, 0, 0, 0.4);--input-border: #454545;--icon-color: #cccccc;--text-primary: #cccccc;--text-secondary: #cccccc;--text-placeholder: #999999;--keybinding-bg: #3c3c3c;--keybinding-border: #555555;--keybinding-text: #cccccc;--hover-bg: #333739;--selected-bg: #2a2d2e;--highlight-bg: #ffff05;--highlight-text: #ffffff;}
  }.search-backdrop.svelte-1ocnzw1 {position:fixed;inset:0;background-color:var(--backdrop-bg);z-index:9999;display:flex;align-items:flex-start;justify-content:center;padding-top:10vh;}.search-dialog.svelte-1ocnzw1 {width:100%;max-width:640px;background-color:var(--dialog-bg);border:1px solid var(--dialog-border);border-radius:var(--border-radius);box-shadow:0 8px 32px var(--dialog-shadow);}.search-container.svelte-1ocnzw1 {display:flex;flex-direction:column;max-height:70vh;}.search-input-wrapper.svelte-1ocnzw1 {position:relative;display:flex;align-items:center;padding:12px 16px;border-bottom:1px solid var(--input-border);color:var(--icon-color);}.search-input.svelte-1ocnzw1 {flex:1;margin:0 12px;padding:0;background:none;border:none;outline:none;color:var(--text-primary);font-size:16px;font-family:inherit;}.search-input.svelte-1ocnzw1::placeholder {color:var(--text-placeholder);}.search-input.svelte-1ocnzw1:disabled {opacity:0.5;cursor:not-allowed;}.search-shortcut.svelte-1ocnzw1 {padding:4px 8px;background-color:var(--keybinding-bg);border:1px solid var(--keybinding-border);border-radius:4px;color:var(--keybinding-text);font-size:11px;font-family:monospace;flex-shrink:0;}.search-empty.svelte-1ocnzw1 {padding:32px 16px;text-align:center;color:var(--text-secondary);opacity:0.6;}.search-results.svelte-1ocnzw1 {list-style:none;margin:0;padding:8px 0;overflow-y:auto;max-height:calc(70vh - 120px);}.search-result-item.svelte-1ocnzw1 {display:flex;flex-direction:column;gap:4px;padding:12px 16px;cursor:pointer;transition:background-color 0.2s ease;}.search-result-item.svelte-1ocnzw1:hover {background-color:var(--hover-bg);}.search-result-item[data-selected='true'].svelte-1ocnzw1 {background-color:var(--selected-bg);}.result-header.svelte-1ocnzw1 {display:flex;align-items:center;justify-content:space-between;}.result-thread-name.svelte-1ocnzw1 {max-width:90%;font-weight:600;color:var(--text-primary);font-size:13px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.result-date.svelte-1ocnzw1 {font-size:11px;color:var(--text-secondary);opacity:0.5;}.result-content.svelte-1ocnzw1 {color:var(--text-primary);font-size:12px;opacity:0.6;word-break:break-all;height:1rem; /* 固定高度 */text-overflow:ellipsis;overflow:hidden;}.result-content.svelte-1ocnzw1 mark {opacity:1;background-color:var(--highlight-bg);color:var(--highlight-text);border-radius:2px;}.search-footer.svelte-1ocnzw1 {display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-top:1px solid var(--input-border);background-color:var(--dialog-bg);}.search-tips.svelte-1ocnzw1 {display:flex;align-items:center;gap:8px;font-size:11px;color:var(--text-secondary);opacity:0.6;}.search-tips.svelte-1ocnzw1 kbd:where(.svelte-1ocnzw1) {padding:2px 6px;background-color:var(--keybinding-bg);border:1px solid var(--keybinding-border);border-radius:3px;color:var(--keybinding-text);font-size:10px;font-family:monospace;}.search-results-count.svelte-1ocnzw1 {font-size:11px;color:var(--text-secondary);opacity:0.6;}.sr-only.svelte-1ocnzw1 {position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;}`};function Lo(e,t){yt(t,!0),li(e,Io);let n=P(!1),r=P(``),i=P(pn([])),a=P(0),o=P(!1),s=P(void 0),c=P(void 0);$i(async()=>{F(o,!0);try{await Co.initializeIndex()}catch(e){console.error(`[Search UI] Failed to initialize search index:`,e)}finally{F(o,!1)}}),wo(window,`keydown`,e=>{(e.metaKey||e.ctrlKey)&&e.key===`k`&&(e.preventDefault(),l())});function l(){F(n,!J(n)),J(n)?setTimeout(()=>{J(s)?.focus()},0):(F(r,``),F(i,[],!0),F(a,0))}function u(){F(n,!1),F(r,``),F(i,[],!0),F(a,0)}function d(){setTimeout(()=>{let e=J(c)?.querySelector(`[data-selected="true"]`);e&&e.scrollIntoView({block:`nearest`})},0)}function f(e){window.location.href=`/copilot/c/${e.threadId}`,u()}function p(e){let t=new Date(e),n=new Date().getTime()-t.getTime(),r=Math.floor(n/(1e3*60*60*24));return r===0?`今天`:r===1?`昨天`:r<7?`${r} 天前`:r<30?`${Math.floor(r/7)} 周前`:t.toLocaleDateString(`zh-CN`,{year:`numeric`,month:`2-digit`,day:`2-digit`})}var m=Ur(),h=Sn(m),g=e=>{var t=Fo();t.__click=[ko,u];var n=R(t),l=R(n),m=R(l),h=R(m);Eo(h,{});var g=Cn(h,4);ki(g),g.__input=[Do,r,i,a],g.__keydown=[Oo,r,i,a,u,d,f],Xi(g,e=>F(s,e),()=>J(s)),ft(2),A(m);var _=Cn(m,2),v=e=>{var t=Ao();Wr(e,t)};Qr(_,e=>{J(r)&&J(i).length===0&&e(v)});var y=Cn(_,2),b=e=>{var t=Po();ni(t,21,()=>J(i),ei,(e,t,n)=>{var r=No();Z(r,`id`,`result-${n}`),r.__click=[jo,f,t],r.__keydown=[Mo,f,t];var i=R(r),o=R(i),s=R(o,!0);A(o);var c=Cn(o,2),l=R(c,!0);A(c),A(i);var u=Cn(i,2),d=R(u);ci(d,()=>J(t).highlightedContent||J(t).messageContent),A(u),A(r),Hn((e,i)=>{Z(r,`aria-selected`,n===J(a)),Z(r,`data-selected`,n===J(a)),Z(o,`title`,J(t).threadName),Kr(s,J(t).threadName),Z(c,`title`,e),Kr(l,i)},[()=>new Date(J(t).createdAt).toLocaleString(),()=>p(J(t).createdAt)]),Wr(e,r)}),A(t),Xi(t,e=>F(c,e),()=>J(c)),Wr(e,t)};Qr(y,e=>{J(i).length>0&&e(b)});var x=Cn(y,2),S=Cn(R(x),2),C=R(S);A(S),A(x),A(l),A(n),A(t),Hn(()=>{Z(g,`placeholder`,J(o)?`正在建立索引...`:`搜索聊天记录...`),g.disabled=J(o),Z(g,`aria-expanded`,J(i).length>0),Z(g,`aria-activedescendant`,J(i).length>0?`result-${J(a)}`:void 0),Kr(C,`${J(i).length??``} 条结果`)}),Ki(g,()=>J(r),e=>F(r,e)),Wi(3,n,()=>aa,()=>({y:-20,duration:200})),Wi(3,t,()=>ia,()=>({duration:150})),Wr(e,t)};Qr(h,e=>{J(n)&&e(g)}),Wr(e,m),bt()}Ir([`click`,`input`,`keydown`]);function Ro(){let e=`copilot-chat-search`,t=document.getElementById(e);t||(t=document.createElement(`div`),t.id=e,document.documentElement.appendChild(t));let n=t.shadowRoot??t.attachShadow({mode:`open`});qr(Lo,{target:n})}n({onBeforeFetch:async({request:e,fetch:t})=>{if(e.method!==`GET`)return;let[n,r]=e.url?.match(/\/github\/chat\/threads\/([^/]+)\/messages/)??[];if(!r)return;try{let n=await t(e);if(!n.ok)throw Error(`Failed to fetch thread messages: ${n.statusText} ${await n.text()}`);return n}catch(e){console.warn(`[Intercept] Error fetching thread messages:`,e)}let i=await T.getMessages(r);return i?(console.info(`[Intercept] Returning local messages for thread ${r}`,i),new Response(JSON.stringify({thread:await T.getThread(r),messages:i.messages}),{status:200,statusText:`OK`,headers:{"Content-Type":`application/json`}})):e}}),n({onBeforeFetch:async({request:e,response:t})=>{if(e.method!==`DELETE`)return;let[n,r]=e.url?.match(/\/github\/chat\/threads\/([^/]+)/)??[];if(r)try{await T.deleteThread(r),console.info(`[Intercept] Deleted thread ${r} from local DB.`)}catch(e){console.error(`[Intercept] Failed to delete thread ${r}:`,e)}}}),n({onAfterFetch:async({request:e,response:t})=>{if(e.method===`GET`&&new URL(e.url).pathname===`/github/chat/threads`){try{let e=await t.clone().json(),n=await Te(e);return new Response(JSON.stringify(n),{status:t.status,statusText:t.statusText,headers:t.headers})}catch(e){console.error(`[Intercept] Failed to merge threads response:`,e)}return t}}});async function zo(){console.info(`[Github Copilot Enhanced] Initializing...`),document.readyState===`complete`?we.startAutoSync(30):window.addEventListener(`load`,()=>{we.startAutoSync(30)}),Ro(),console.info(`[Github Copilot Enhanced] Initialized.`)}zo()})();